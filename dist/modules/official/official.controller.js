'use strict';const _0x36a84c=_0x21f0;(function(_0x48a2c3,_0x376036){const _0x122501=_0x21f0,_0x22136f=_0x48a2c3();while(!![]){try{const _0x20e1b7=parseInt(_0x122501(0x103))/0x1*(-parseInt(_0x122501(0xe0))/0x2)+parseInt(_0x122501(0xba))/0x3+-parseInt(_0x122501(0xd4))/0x4+-parseInt(_0x122501(0x10d))/0x5*(-parseInt(_0x122501(0xd6))/0x6)+parseInt(_0x122501(0x107))/0x7+-parseInt(_0x122501(0xbc))/0x8+parseInt(_0x122501(0xe4))/0x9*(parseInt(_0x122501(0xe8))/0xa);if(_0x20e1b7===_0x376036)break;else _0x22136f['push'](_0x22136f['shift']());}catch(_0x40999f){_0x22136f['push'](_0x22136f['shift']());}}}(_0x443e,0xf3066));function _0x443e(){const _0x263af3=['Query','OfficialController','ApiTags','Get','scanBindWx','ISDEV','loginByCode','../../common/auth/jwtAuth.guard','获取绑定二维码的sceneStr','./dto/getQrCode.dto','officialScanLoginText','function','unsubscribe','prototype','bindWxBySceneStr','length','VIEW','4318572IljQxa','__esModule','6GLAsRZ','CLICK','includes','split','url','fromusername','公众号通知接口POST','officialService','扫码绑定轮询查询','sceneStr','3336566EhIwZV','msgtype','notify','nonce','26925543AVjLPQ','GetQrCodeDto','genXmlMsg','design:returntype','10XCquvM','TRUE','获取登录二维码sceneStr','eventkey','officialSubscribeText','Post','echostr','公众号静默登录','officialBindAccountText','verify','getQRSceneStr','code','__metadata','Body','ApiOperation','UseGuards','JwtAuthGuard','getQRCodeTicket','defineProperty','env','获取登录跳转地址','Res','object','signature','notifyPost','getQRCode','metadata','1PKGIUW','genXmlMsgByConfig','official','getQRSceneStrByBind','1944915JCXLzF','design:paramtypes','status','xml:\x20','text','subscribe','3697145ZEmPDc','design:type','https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=','aotoPlay','公众号通知接口GET','loginBySceneStr','getJsapiTicket','get\x20通知>>>','扫码登录轮询查询','log','Req','GetQrSceneStrDto','decorate','sceneStr:\x20','2619606BVCuYV','@nestjs/swagger','9110776aaVrQI','getRedirectUrl','content','send','success','scan','event'];_0x443e=function(){return _0x263af3;};return _0x443e();}var __decorate=this&&this['__decorate']||function(_0x23f99a,_0xf29814,_0x36717b,_0x3a3b59){const _0x511075=_0x21f0;var _0x119f7f=arguments[_0x511075(0xd2)],_0x5f40bf=_0x119f7f<0x3?_0xf29814:_0x3a3b59===null?_0x3a3b59=Object['getOwnPropertyDescriptor'](_0xf29814,_0x36717b):_0x3a3b59,_0x471073;if(typeof Reflect===_0x511075(0xfe)&&typeof Reflect[_0x511075(0x119)]===_0x511075(0xce))_0x5f40bf=Reflect['decorate'](_0x23f99a,_0xf29814,_0x36717b,_0x3a3b59);else{for(var _0x2a6c13=_0x23f99a[_0x511075(0xd2)]-0x1;_0x2a6c13>=0x0;_0x2a6c13--)if(_0x471073=_0x23f99a[_0x2a6c13])_0x5f40bf=(_0x119f7f<0x3?_0x471073(_0x5f40bf):_0x119f7f>0x3?_0x471073(_0xf29814,_0x36717b,_0x5f40bf):_0x471073(_0xf29814,_0x36717b))||_0x5f40bf;}return _0x119f7f>0x3&&_0x5f40bf&&Object[_0x511075(0xfa)](_0xf29814,_0x36717b,_0x5f40bf),_0x5f40bf;},__metadata=this&&this[_0x36a84c(0xf4)]||function(_0x1737ff,_0x51b1e1){const _0x388e6f=_0x36a84c;if(typeof Reflect===_0x388e6f(0xfe)&&typeof Reflect[_0x388e6f(0x102)]===_0x388e6f(0xce))return Reflect[_0x388e6f(0x102)](_0x1737ff,_0x51b1e1);},__param=this&&this['__param']||function(_0x5879f4,_0x2f820e){return function(_0x4314f0,_0x36a0d0){_0x2f820e(_0x4314f0,_0x36a0d0,_0x5879f4);};};function _0x21f0(_0xb2e785,_0x103695){const _0x443e2c=_0x443e();return _0x21f0=function(_0x21f003,_0x484564){_0x21f003=_0x21f003-0xba;let _0x470f77=_0x443e2c[_0x21f003];return _0x470f77;},_0x21f0(_0xb2e785,_0x103695);}Object[_0x36a84c(0xfa)](exports,_0x36a84c(0xd5),{'value':!![]}),exports[_0x36a84c(0xc4)]=void 0x0;const common_1=require('@nestjs/common'),swagger_1=require(_0x36a84c(0xbb)),jwtAuth_guard_1=require(_0x36a84c(0xca)),official_service_1=require('./official.service'),getQrCode_dto_1=require(_0x36a84c(0xcc)),getQrSceneStr_dto_1=require('./dto/getQrSceneStr.dto');let OfficialController=class OfficialController{constructor(_0x42a9cb){const _0x1d4b5d=_0x36a84c;this[_0x1d4b5d(0xdd)]=_0x42a9cb;}async['notify'](_0x3ed262,_0x30710c,_0x180297){const _0x4b4018=_0x36a84c;console[_0x4b4018(0x116)](_0x4b4018(0x114),_0x30710c,_0x180297);const _0x35238d=await this[_0x4b4018(0xdd)][_0x4b4018(0xf1)](_0x30710c[_0x4b4018(0xff)],_0x30710c[_0x4b4018(0xe3)],_0x30710c['timestamp']);return _0x35238d?_0x30710c[_0x4b4018(0xee)]:'';}async[_0x36a84c(0x100)](_0x5a3053,_0x1e8cb4,_0x3bc9d6,_0x127137){const _0x33c656=_0x36a84c,{xml:_0x4fbd1e}=_0x3bc9d6;console[_0x33c656(0x116)](_0x33c656(0x10a),_0x4fbd1e);if(_0x4fbd1e[_0x33c656(0xe1)][0x0]==_0x33c656(0xc2)){if(_0x4fbd1e[_0x33c656(0xc2)][0x0]==_0x33c656(0xd3)||_0x4fbd1e[_0x33c656(0xc2)][0x0]==_0x33c656(0xd7))return _0x127137['status'](0xc8)['send']('');if(_0x4fbd1e['event'][0x0]=='SCAN'){console[_0x33c656(0x116)]('扫码');const _0x1e68f0=_0x4fbd1e[_0x33c656(0xeb)][0x0];if(_0x1e68f0['includes']('/')){this[_0x33c656(0xdd)][_0x33c656(0xc7)](_0x4fbd1e[_0x33c656(0xdb)][0x0],_0x1e68f0);const _0x52ec1d=await this[_0x33c656(0xdd)]['genXmlMsgByConfig'](_0x4fbd1e,_0x33c656(0xf0));return _0x127137[_0x33c656(0x109)](0xc8)['send'](_0x52ec1d);}this['officialService'][_0x33c656(0xc1)](_0x4fbd1e[_0x33c656(0xdb)][0x0],_0x1e68f0);const _0x5180a6=await this[_0x33c656(0xdd)][_0x33c656(0x104)](_0x4fbd1e,_0x33c656(0xcd));return _0x127137[_0x33c656(0x109)](0xc8)['send'](_0x5180a6);}if(_0x4fbd1e['event'][0x0]==_0x33c656(0x10c)){console[_0x33c656(0x116)]('订阅',_0x4fbd1e['eventkey'][0x0]);const _0x570a26=_0x4fbd1e[_0x33c656(0xeb)][0x0][_0x33c656(0xd9)]('qrscene_')[0x1];console[_0x33c656(0x116)](_0x33c656(0x11a),_0x570a26);if(!_0x570a26){const _0x3130a1=await this[_0x33c656(0xdd)][_0x33c656(0x104)](_0x4fbd1e,_0x33c656(0xec));return _0x127137['status'](0xc8)[_0x33c656(0xbf)](_0x3130a1);}if(_0x570a26[_0x33c656(0xd8)]('/')){this[_0x33c656(0xdd)][_0x33c656(0xc7)](_0x4fbd1e['fromusername'][0x0],_0x570a26);const _0x3ab2af=await this[_0x33c656(0xdd)][_0x33c656(0x104)](_0x4fbd1e,_0x33c656(0xf0));return _0x127137[_0x33c656(0x109)](0xc8)[_0x33c656(0xbf)](_0x3ab2af);}this[_0x33c656(0xdd)][_0x33c656(0xc1)](_0x4fbd1e['fromusername'][0x0],_0x570a26);const _0x40d44f=await this[_0x33c656(0xdd)][_0x33c656(0x104)](_0x4fbd1e,_0x33c656(0xec));return _0x127137[_0x33c656(0x109)](0xc8)[_0x33c656(0xbf)](_0x40d44f);}if(_0x4fbd1e[_0x33c656(0xc2)][0x0]==_0x33c656(0xcf))return _0x127137[_0x33c656(0x109)](0xc8)[_0x33c656(0xbf)]('');}if(_0x4fbd1e[_0x33c656(0xe1)][0x0]==_0x33c656(0x10b)){const _0x534ad6=await this[_0x33c656(0xdd)][_0x33c656(0x110)](_0x4fbd1e[_0x33c656(0xbe)][0x0]),_0x18d5ac=await this['officialService'][_0x33c656(0xe6)](_0x4fbd1e,_0x534ad6);return _0x127137['status'](0xc8)['send'](_0x18d5ac);}return _0x33c656(0xc0);}async['getQRSceneStr'](_0x140d5e){const _0x1e1b21=_0x36a84c;return this['officialService'][_0x1e1b21(0xf2)](_0x140d5e);}async[_0x36a84c(0x106)](_0x4a31b8){const _0x28742d=_0x36a84c;return this[_0x28742d(0xdd)][_0x28742d(0x106)](_0x4a31b8);}async[_0x36a84c(0x101)](_0x54ee7a){const _0x49f0a3=_0x36a84c;if(process[_0x49f0a3(0xfb)][_0x49f0a3(0xc8)]===_0x49f0a3(0xe9))return'';const _0x13e84a=await this[_0x49f0a3(0xdd)][_0x49f0a3(0xf9)](_0x54ee7a[_0x49f0a3(0xdf)]);return _0x49f0a3(0x10f)+encodeURIComponent(_0x13e84a);}async[_0x36a84c(0x112)](_0x39a09b,_0x592607){const _0x31c5fa=_0x36a84c;return this[_0x31c5fa(0xdd)][_0x31c5fa(0x112)](_0x39a09b,_0x592607['sceneStr']);}async[_0x36a84c(0xd1)](_0x52c2fb,_0x47788f){const _0x395b12=_0x36a84c;return this['officialService']['bindWxBySceneStr'](_0x52c2fb,_0x47788f[_0x395b12(0xdf)]);}async['getRedirectUrl'](_0x1fbc71){const _0x45bfd1=_0x36a84c;return this[_0x45bfd1(0xdd)][_0x45bfd1(0xbd)](_0x1fbc71[_0x45bfd1(0xda)]);}async['getJsapiTicket'](_0x5c6cc3){const _0x28a1e0=_0x36a84c;return this[_0x28a1e0(0xdd)][_0x28a1e0(0x113)](_0x5c6cc3['url']);}async[_0x36a84c(0xc9)](_0x5b790b,_0x5ee47a){const _0x4cf554=_0x36a84c;return this['officialService'][_0x4cf554(0xc9)](_0x5b790b,_0x5ee47a[_0x4cf554(0xf3)]);}};__decorate([(0x0,common_1[_0x36a84c(0xc6)])(_0x36a84c(0xe2)),(0x0,swagger_1['ApiOperation'])({'summary':_0x36a84c(0x111)}),__param(0x0,(0x0,common_1[_0x36a84c(0x117)])()),__param(0x1,(0x0,common_1[_0x36a84c(0xc3)])()),__param(0x2,(0x0,common_1['Body'])()),__metadata(_0x36a84c(0x10e),Function),__metadata(_0x36a84c(0x108),[Object,Object,Object]),__metadata(_0x36a84c(0xe7),Promise)],OfficialController[_0x36a84c(0xd0)],_0x36a84c(0xe2),null),__decorate([(0x0,common_1[_0x36a84c(0xed)])(_0x36a84c(0xe2)),(0x0,swagger_1[_0x36a84c(0xf6)])({'summary':_0x36a84c(0xdc)}),__param(0x0,(0x0,common_1[_0x36a84c(0x117)])()),__param(0x1,(0x0,common_1[_0x36a84c(0xc3)])()),__param(0x2,(0x0,common_1[_0x36a84c(0xf5)])()),__param(0x3,(0x0,common_1[_0x36a84c(0xfd)])()),__metadata(_0x36a84c(0x10e),Function),__metadata(_0x36a84c(0x108),[Object,Object,Object,Object]),__metadata(_0x36a84c(0xe7),Promise)],OfficialController[_0x36a84c(0xd0)],_0x36a84c(0x100),null),__decorate([(0x0,common_1[_0x36a84c(0xed)])(_0x36a84c(0xf2)),(0x0,swagger_1[_0x36a84c(0xf6)])({'summary':_0x36a84c(0xea)}),__param(0x0,(0x0,common_1[_0x36a84c(0xf5)])()),__metadata(_0x36a84c(0x10e),Function),__metadata(_0x36a84c(0x108),[getQrSceneStr_dto_1[_0x36a84c(0x118)]]),__metadata('design:returntype',Promise)],OfficialController['prototype'],_0x36a84c(0xf2),null),__decorate([(0x0,common_1[_0x36a84c(0xed)])(_0x36a84c(0x106)),(0x0,swagger_1[_0x36a84c(0xf6)])({'summary':_0x36a84c(0xcb)}),(0x0,common_1['UseGuards'])(jwtAuth_guard_1[_0x36a84c(0xf8)]),__param(0x0,(0x0,common_1['Req'])()),__metadata(_0x36a84c(0x10e),Function),__metadata(_0x36a84c(0x108),[Object]),__metadata(_0x36a84c(0xe7),Promise)],OfficialController['prototype'],_0x36a84c(0x106),null),__decorate([(0x0,common_1[_0x36a84c(0xc6)])(_0x36a84c(0x101)),(0x0,swagger_1['ApiOperation'])({'summary':'获取二维码'}),__param(0x0,(0x0,common_1[_0x36a84c(0xc3)])()),__metadata(_0x36a84c(0x10e),Function),__metadata(_0x36a84c(0x108),[getQrCode_dto_1[_0x36a84c(0xe5)]]),__metadata(_0x36a84c(0xe7),Promise)],OfficialController[_0x36a84c(0xd0)],'getQRCode',null),__decorate([(0x0,common_1[_0x36a84c(0xed)])(_0x36a84c(0x112)),(0x0,swagger_1['ApiOperation'])({'summary':_0x36a84c(0x115)}),__param(0x0,(0x0,common_1[_0x36a84c(0x117)])()),__param(0x1,(0x0,common_1[_0x36a84c(0xf5)])()),__metadata(_0x36a84c(0x10e),Function),__metadata(_0x36a84c(0x108),[Object,getQrCode_dto_1[_0x36a84c(0xe5)]]),__metadata('design:returntype',Promise)],OfficialController[_0x36a84c(0xd0)],'loginBySceneStr',null),__decorate([(0x0,common_1[_0x36a84c(0xed)])(_0x36a84c(0xd1)),(0x0,swagger_1[_0x36a84c(0xf6)])({'summary':_0x36a84c(0xde)}),(0x0,common_1[_0x36a84c(0xf7)])(jwtAuth_guard_1[_0x36a84c(0xf8)]),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x36a84c(0xf5)])()),__metadata(_0x36a84c(0x10e),Function),__metadata('design:paramtypes',[Object,getQrCode_dto_1[_0x36a84c(0xe5)]]),__metadata('design:returntype',Promise)],OfficialController[_0x36a84c(0xd0)],_0x36a84c(0xd1),null),__decorate([(0x0,common_1['Post'])('getRedirectUrl'),(0x0,swagger_1[_0x36a84c(0xf6)])({'summary':_0x36a84c(0xfc)}),__param(0x0,(0x0,common_1[_0x36a84c(0xf5)])()),__metadata(_0x36a84c(0x10e),Function),__metadata(_0x36a84c(0x108),[Object]),__metadata(_0x36a84c(0xe7),Promise)],OfficialController[_0x36a84c(0xd0)],_0x36a84c(0xbd),null),__decorate([(0x0,common_1[_0x36a84c(0xed)])('getJsapiTicket'),(0x0,swagger_1[_0x36a84c(0xf6)])({'summary':'获取注册配置'}),__param(0x0,(0x0,common_1[_0x36a84c(0xf5)])()),__metadata(_0x36a84c(0x10e),Function),__metadata(_0x36a84c(0x108),[Object]),__metadata(_0x36a84c(0xe7),Promise)],OfficialController[_0x36a84c(0xd0)],'getJsapiTicket',null),__decorate([(0x0,common_1[_0x36a84c(0xed)])(_0x36a84c(0xc9)),(0x0,swagger_1[_0x36a84c(0xf6)])({'summary':_0x36a84c(0xef)}),__param(0x0,(0x0,common_1[_0x36a84c(0x117)])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0x36a84c(0x10e),Function),__metadata(_0x36a84c(0x108),[Object,Object]),__metadata(_0x36a84c(0xe7),Promise)],OfficialController[_0x36a84c(0xd0)],_0x36a84c(0xc9),null),OfficialController=__decorate([(0x0,swagger_1[_0x36a84c(0xc5)])(_0x36a84c(0x105)),(0x0,common_1['Controller'])('official'),__metadata(_0x36a84c(0x108),[official_service_1['OfficialService']])],OfficialController),exports[_0x36a84c(0xc4)]=OfficialController;