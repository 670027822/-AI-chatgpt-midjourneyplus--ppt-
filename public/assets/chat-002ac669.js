import{_ as Nt}from"./index.vue_vue_type_style_index_0_lang-1fba6e1b.js";import{i as tt,M as qt,H as Pe,m as Ut,a as zt,C as Gt,D as Ot,R as Pt,u as Et,h as Vt}from"./useIconRender-612377fe.js";import{d as Q,aa as se,e as fe,u as be,b as f,o as a,c as p,j as e,C as F,ab as Ee,ac as Ve,F as pe,k as t,a5 as Ze,r as x,ad as T,a6 as lt,n as L,t as O,i as c,l as m,z as Fe,y as de,p as S,g as _e,a9 as ve,h as ke,ae as Ft,f as Ke,af as at,J as B,A as P,K as ue,m as xe,a8 as it,ag as Ht,R as rt,U as He,ah as Zt,S as ct,H as Kt,ai as ot,w as ce,aj as Jt,ak as Wt,N as nt,al as Yt,am as st,an as Qt}from"./index-b6f4ce48.js";import{c as ut}from"./index-c94da121.js";import"./Popconfirm-bffdc0e7.js";import"./NumberAnimation-75696008.js";import"./LayoutSider-3b9d93db.js";import"./katex-d97319dc.js";const Xt={key:1,class:"text-[28px] dark:text-white"},eo={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32","aria-hidden":"true",width:"1em",height:"1em"},to=t("path",{d:"M29.71,13.09A8.09,8.09,0,0,0,20.34,2.68a8.08,8.08,0,0,0-13.7,2.9A8.08,8.08,0,0,0,2.3,18.9,8,8,0,0,0,3,25.45a8.08,8.08,0,0,0,8.69,3.87,8,8,0,0,0,6,2.68,8.09,8.09,0,0,0,7.7-5.61,8,8,0,0,0,5.33-3.86A8.09,8.09,0,0,0,29.71,13.09Zm-12,16.82a6,6,0,0,1-3.84-1.39l.19-.11,6.37-3.68a1,1,0,0,0,.53-.91v-9l2.69,1.56a.08.08,0,0,1,.05.07v7.44A6,6,0,0,1,17.68,29.91ZM4.8,24.41a6,6,0,0,1-.71-4l.19.11,6.37,3.68a1,1,0,0,0,1,0l7.79-4.49V22.8a.09.09,0,0,1,0,.08L13,26.6A6,6,0,0,1,4.8,24.41ZM3.12,10.53A6,6,0,0,1,6.28,7.9v7.57a1,1,0,0,0,.51.9l7.75,4.47L11.85,22.4a.14.14,0,0,1-.09,0L5.32,18.68a6,6,0,0,1-2.2-8.18Zm22.13,5.14-7.78-4.52L20.16,9.6a.08.08,0,0,1,.09,0l6.44,3.72a6,6,0,0,1-.9,10.81V16.56A1.06,1.06,0,0,0,25.25,15.67Zm2.68-4-.19-.12-6.36-3.7a1,1,0,0,0-1.05,0l-7.78,4.49V9.2a.09.09,0,0,1,0-.09L19,5.4a6,6,0,0,1,8.91,6.21ZM11.08,17.15,8.38,15.6a.14.14,0,0,1-.05-.08V8.1a6,6,0,0,1,9.84-4.61L18,3.6,11.61,7.28a1,1,0,0,0-.53.91ZM12.54,14,16,12l3.47,2v4L16,20l-3.47-2Z",fill:"currentColor"},null,-1),oo=[to],no=Q({__name:"Avatar",props:{image:{type:Boolean}},setup(o){const u=se(),{isMobile:i}=fe(),d=be(),r=f(()=>d.userInfo.avatar),g=f(()=>{var k;return((k=v.value)==null?void 0:k.appLogo)||d.globalConfig.robotAvatar}),v=f(()=>u.groupList.find(k=>k.uuid===u.active));return(k,C)=>o.image?(a(),p(pe,{key:0},[e(tt)(e(r))&&e(r).length>0?(a(),F(e(Ve),{key:0,size:e(i)?32:42,src:e(r),"fallback-src":e(Ee)},null,8,["size","src","fallback-src"])):(a(),F(e(Ve),{key:1,size:e(i)?32:42,src:e(Ee)},null,8,["size","src"]))],64)):(a(),p("span",Xt,[e(tt)(e(g))&&e(g).length>0?(a(),F(e(Ve),{key:0,style:{"background-color":"transparent"},size:(e(i),32),src:e(g),"fallback-src":e(Ee)},null,8,["size","src","fallback-src"])):(a(),p("svg",eo,oo))]))}}),dt="/assets/voice-d6e46d06-d6e46d06.gif",so={key:0,class:"flex flex-col items-start"},lo={class:"w-full"},ao=["innerHTML"],io=["textContent"],ro={class:"mt-3",style:{"margin-top":"0.2rem",display:"flex","justify-content":"space-between",width:"100%"}},co=t("span",{class:"text-xs"},"复制",-1),uo=t("span",{class:"ml-4"},null,-1),po=t("span",{class:"text-xs"},"删除",-1),fo=t("span",{class:"ml-4"},null,-1),ho={key:0,style:{display:"flex"}},go={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",class:"text-[15px] mr-[2px] mb-[2px] iconify iconify--icon-park-outline",width:"1em",height:"1em",viewBox:"0 0 48 48",style:{"font-size":"20px"}},mo=t("g",{fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"4"},[t("path",{d:"M24 44c11.046 0 20-8.954 20-20S35.046 4 24 4S4 12.954 4 24s8.954 20 20 20Z"}),t("path",{d:"M20 24v-6.928l6 3.464L32 24l-6 3.464l-6 3.464z"})],-1),vo=[mo],xo=t("span",{class:"text-xs",style:{display:"flex","padding-left":"2px","padding-top":"2px"}},"朗读",-1),yo={key:1,style:{display:"flex"}},bo=t("img",{src:dt,class:"h-[16px] ml-1",style:{height:"25px",width:"30px"}},null,-1),_o=t("img",{src:dt,class:"h-[16px] ml-1",style:{height:"25px",width:"30px"}},null,-1),ko=[bo,_o],wo=t("span",{class:"ml-4"},null,-1),Co=t("span",{class:"text-xs"},"重答",-1),$o={key:1},Io=["textContent"],To=Q({__name:"Text",props:{inversion:{type:Boolean},error:{type:Boolean},text:null,loading:{type:Boolean},asRawText:{type:Boolean},loadingbf:{type:Boolean}},emits:["regenerate","delete","copy","yuyin"],setup(o,{expose:u,emit:i}){const d=o,{proxy:r,ctx:g}=Ze(),{isMobile:v}=fe(),k=x(),C=new qt({linkify:!0,highlight(R,U){if(!!(U&&Pe.getLanguage(U))){const ge=U??"";return $(Pe.highlight(R,{language:ge}).value,ge)}return $(Pe.highlightAuto(R).value,"")}});C.use(Ut,{attrs:{target:"_blank",rel:"noopener"}}),C.use(zt,{blockClass:"katexmath-block rounded-md p-[10px]",errorColor:" #cc0000"});const w=f(()=>["text-wrap","min-w-[20px]","rounded-md",v.value?"p-2":"px-3 py-2",d.inversion?"bg-[#846EF7]":"bg-[#ebebeb]",d.inversion?"text-[#fff]":"text-[#000]",d.inversion?"dark:bg-[#846EF7]":"dark:bg-[#1e1e20]",d.inversion?"message-request":"message-reply",{"text-red-500":d.error}]),h=f(()=>{const R=d.text??"";return d.asRawText?R:C.render(R)});function $(R,U){return`<pre class="code-block-wrapper"><div class="code-block-header"><span class="code-block-header__lang">${U}</span><span class="code-block-header__copy">${T("chat.copyCode")}</span></div><code class="hljs code-block-body ${U}">${R}</code></pre>`}function I(){i("regenerate")}function y(){i("copy")}function j(){i("delete")}let N=x(!1),b=!1;function E(){if(b){console.log("请等待当前语音播放完毕。");return}b=!0,N.value=!0;let R=r.$loadings.value;i("yuyin");let U=setInterval(()=>{r.$loadings.value!==R?(clearInterval(U),N.value=!1,b=!1):console.log("音频播放中")},400)}return lt(()=>{}),u({textRef:k}),(R,U)=>(a(),p("div",{class:L([e(w),"w-full"])},[t("div",{ref_key:"textRef",ref:k,class:"leading-relaxed break-words"},[o.inversion?(a(),p("div",$o,[t("div",{class:"whitespace-pre-wrap",textContent:O(e(h))},null,8,Io),S("",!0)])):(a(),p("div",so,[t("div",lo,[o.asRawText?(a(),p("div",{key:1,class:"w-full whitespace-pre-wrap",textContent:O(e(h))},null,8,io)):(a(),p("div",{key:0,class:L(["w-full markdown-body",[{"markdown-body-generate":o.loading}]]),innerHTML:e(h)},null,10,ao))]),t("div",ro,[c(e(de),{class:"ml-2",text:"",type:"primary",onClick:y,style:{"--n-text-color":"#5e6472"}},{icon:m(()=>[c(e(Fe),{size:20,component:e(Gt)},null,8,["component"])]),default:m(()=>[co]),_:1}),uo,c(e(de),{text:"",type:"primary",onClick:j,style:{"--n-text-color":"#5e6472"}},{icon:m(()=>[c(e(Fe),{size:20,component:e(Ot)},null,8,["component"])]),default:m(()=>[po]),_:1}),fo,t("span",{class:"flex text-[#616876] cursor-pointer hover:text-primary items-center",style:{"margin-top":"5px",width:"60px"},onClick:E},[e(N)?S("",!0):(a(),p("div",ho,[(a(),p("svg",go,vo)),xo])),e(N)?(a(),p("div",yo,ko)):S("",!0)]),wo,c(e(de),{text:"",type:"primary",onClick:I,style:{"--n-text-color":"#5e6472"}},{icon:m(()=>[c(e(Fe),{size:20,component:e(Pt)},null,8,["component"])]),default:m(()=>[Co]),_:1})])]))],512)],2))}});const So={class:"items-end gap-1 mt-2"},Lo=Q({__name:"index",props:{dateTime:null,text:null,inversion:{type:Boolean},error:{type:Boolean},loading:{type:Boolean}},emits:["regenerate","delete","yuyin"],setup(o,{emit:u}){const i=o,d=_e();fe();const{iconRender:r}=Et(),g=x(),v=x(i.inversion),k=x();f(()=>{const I=[{label:T("chat.copy"),key:"copyText",icon:r({icon:"ri:file-copy-2-line"})},{label:T("common.delete"),key:"delete",icon:r({icon:"ri:delete-bin-line"})}];return i.inversion||I.unshift({label:v.value?T("chat.preview"):T("chat.showRawText"),key:"toggleRenderType",icon:r({icon:v.value?"ic:outline-code-off":"ic:outline-code"})}),I});function C(){u("delete")}function w(){u("yuyin")}function h(){ut({text:i.text??""}),i.text&&d.success("复制成功！")}function $(){var I;(I=k.value)==null||I.scrollIntoView(),u("regenerate")}return(I,y)=>(a(),p("div",{style:{"margin-bottom":"0.2rem"},ref_key:"messageRef",ref:k,class:L(["flex w-full mb-6 overflow-hidden items-start",[{"flex-row-reverse":o.inversion}]])},[t("div",{class:L(["flex items-center justify-center flex-shrink-0 mt-1",[o.inversion?"ml-2":"mr-2"]])},[c(no,{image:o.inversion},null,8,["image"])],2),t("div",{class:L(["overflow-hidden text-sm",[o.inversion?"items-end":"items-start"]]),style:{"max-width":"calc(100% - 80px)"}},[t("p",{class:L(["text-xs text-[#b4bbc4]",[o.inversion?"text-right":"text-left"]])},O(o.dateTime),3),t("div",So,[c(To,{ref_key:"textRef",ref:g,inversion:o.inversion,error:o.error,text:o.text,loading:o.loading,"as-raw-text":v.value,onRegenerate:$,onCopy:h,onDelete:C,onYuyin:w},null,8,["inversion","error","text","loading","as-raw-text"])])],2)],2))}});function Bo(o,u){let i=!1;return function(){i||(o(),i=!0,setTimeout(()=>{i=!1},u))}}function Ro(){const o=x(null),u=async()=>{await ve(),o.value&&(o.value.scrollTop=o.value.scrollHeight)},i=async()=>{await ve(),o.value&&(o.value.scrollTop=0)},d=Bo(r,100);async function r(){o.value&&o.value.scrollHeight-o.value.scrollTop-o.value.clientHeight<=300&&(o.value.scrollTop=o.value.scrollHeight)}return{scrollRef:o,scrollToBottom:u,scrollToTop:i,scrollToBottomIfAtBottom:d}}function Ao(){function o(){document.querySelectorAll(".code-block-wrapper").forEach(i=>{const d=i.querySelector(".code-block-header__copy"),r=i.querySelector(".code-block-body");d&&r&&d.addEventListener("click",()=>{var g;(g=navigator.clipboard)!=null&&g.writeText?navigator.clipboard.writeText(r.textContent??""):ut({text:r.textContent??"",origin:!0})})})}ke(()=>o()),Ft(()=>o())}function Do(){const o=se();return{addGroupChat:r=>{o.addGroupChat(r)},updateGroupChat:(r,g)=>{o.updateGroupChat(r,g)},updateGroupChatSome:(r,g)=>{o.updateGroupChatSome(r,g)}}}function Mo(){const o=_e(),u=se(),i=f(()=>u.usingContext);function d(){u.setUsingContext(!i.value),i.value?o.success(T("chat.turnOnContext")):o.warning(T("chat.turnOffContext"))}return{usingContext:i,toggleUsingContext:d}}function jo(){const o=_e(),u=se(),i=f(()=>u.usingNetwork);function d(){u.setUsingNetwork(!i.value),i.value?o.success("已开启联网模式、上下文状态失效！"):o.warning("已关闭联网模式！")}return{usingNetwork:i,toggleUsingNetwork:d}}function No(){const o=x(!1);return{usingduomo:o,toggleUsingDuomo:()=>{o.value=!o.value}}}const qo={class:"sticky top-0 left-0 right-0 z-30 border-b dark:border-neutral-800 bg-white/80 dark:bg-black/20 backdrop-blur"},Uo={class:"relative flex items-center justify-center min-w-0 overflow-hidden h-14",style:{height:"auto"}},zo={class:"max-w-screen-4xl flex w-full h-full items-center px-4"},Go={key:0,class:"flex items-center"},Oo={class:"flex justify-between items-center h-full w-full"},Po={class:"flex-1 flex ele-drag items-center h-full",style:{width:"40%"}},Eo={class:"scroll-right-to-left"},Vo={class:"flex items-center space-x-2"},Fo={class:"text-base text-slate-500 dark:text-slate-400",style:{color:"orange"}},Ho={class:"flex h-8 w-8 items-center justify-center rounded border transition hover:bg-[#eef0f3] dark:border-neutral-700 dark:hover:bg-[#33373c]"},Zo={class:"text-base text-slate-500 dark:text-slate-400"},Ko={class:"flex items-center gap-4"},Jo={class:"text-base text-slate-500 dark:text-slate-400",style:{color:"rgb(255, 38, 38)"}},Wo={class:"text-base text-slate-500 dark:text-slate-400"},Yo=Q({__name:"index",props:{usingContext:{type:Boolean}},emits:["export","toggleUsingContext","clear","scrollBtn"],setup(o,{emit:u}){const i=be();ke(()=>{r()});function d(){return Ht({url:"/config/liudonggg"})}async function r(){const z=await d();z.data&&(g.value=z.data)}const g=x("欢迎使用AI助手");Ze();const v=_e();x({0:"死板",.1:"专业",.2:"准确",.8:"平衡",1:"创造性",1.3:"离谱",1.6:"荒谬"});const k=[{label:"Auto",key:"auto",icon:"ri:contrast-line"},{label:"Light",key:"light",icon:"ri:sun-foggy-line"},{label:"Dark",key:"dark",icon:"ri:moon-foggy-line"}],C=f(()=>{if(!h.activeConfig)return;const{modelTypeInfo:z,modelInfo:X}=h.activeConfig;if(!(!z||!X))return`${z==null?void 0:z.label} / ${X.modelName}`}),w=Ke(),h=se(),$=at(),I=f(()=>w.siderCollapsed);f(()=>h.getChatByGroupInfo());const{isMobile:y}=fe(),j=f(()=>w.theme);function N(){w.setSiderCollapsed(!I.value)}function b(){const z=document.querySelector("#scrollRef");z&&ve(()=>z.scrollTop=0)}function E(){u("clear")}function R(){u("scrollBtn")}function U(){if($.isChatIn)return v.warning("请等待聊天结束后修改模型信息！");$.updateModelDialog(!0)}const he=f(()=>i.isLogin);function ge(){if(!he.value){i.setLoginDialog(!0);return}$.updateSignInDialog(!0)}return(z,X)=>(a(),p("header",qo,[t("div",Uo,[t("div",zo,[e(y)?(a(),p("div",Go,[t("button",{class:"flex items-center justify-center w-11 h-11",onClick:N},[e(I)?(a(),F(e(B),{key:0,class:"text-2xl",icon:"ri:align-justify"})):(a(),F(e(B),{key:1,class:"text-2xl",icon:"ri:align-right"}))])])):S("",!0),t("div",Oo,[t("div",Po,[t("h1",{class:"container flex-1 px-4 font-bold pr-6 overflow-hidden cursor-pointer select-none text-ellipsis whitespace-nowrap",onDblclick:b},[t("p",Eo,O(g.value),1)],32)]),t("div",Vo,[e(y)?(a(),F(e(ue),{key:0,trigger:"hover",disabled:e(y)},{trigger:m(()=>[t("button",{style:{color:"orange"},class:"flex h-8 w-8 items-center justify-center rounded border transition hover:bg-[#eef0f3] dark:border-neutral-700 dark:hover:bg-[#33373c]",onClick:ge},[t("span",Fo,[c(e(B),{icon:"ant-design:gift-outlined"})])])]),default:m(()=>[P(" 签到领福利 ")]),_:1},8,["disabled"])):S("",!0),e(y)?(a(),F(e(it),{key:1,trigger:"click"},{trigger:m(()=>[t("button",Ho,[t("span",Zo,[c(e(B),{icon:"fluent:dark-theme-24-regular"})])])]),default:m(()=>[t("div",null,[t("div",Ko,[(a(),p(pe,null,xe(k,me=>c(e(de),{key:me.key,size:"small",type:me.key===e(j)?"info":void 0,onClick:Le=>e(w).setTheme(me.key)},{icon:m(()=>[c(e(B),{icon:me.icon},null,8,["icon"])]),_:2},1032,["type","onClick"])),64))])])]),_:1})):S("",!0),c(e(ue),{trigger:"hover",disabled:e(y),style:{color:"rgb(254, 33, 33)"}},{trigger:m(()=>[t("button",{class:"flex h-8 w-8 items-center justify-center rounded border transition hover:bg-[#eef0f3] dark:border-neutral-700 dark:hover:bg-[#33373c]",onClick:E,style:{color:"rgb(244, 56, 56)"}},[t("span",Jo,[c(e(B),{icon:"ant-design:clear-outlined"})])])]),default:m(()=>[P(" 清空本页聊天记录 ")]),_:1},8,["disabled"]),c(e(ue),{trigger:"hover",disabled:e(y)},{trigger:m(()=>[t("button",{class:"flex h-8 w-8 items-center justify-center rounded border transition hover:bg-[#eef0f3] dark:border-neutral-700 dark:hover:bg-[#33373c]",onClick:R},[t("span",Wo,[c(e(B),{icon:"material-symbols:keyboard-arrow-down"})])])]),default:m(()=>[P(" 滚动到底部 ")]),_:1},8,["disabled"])])])])]),t("div",{class:"absolute left-1/2 top-full -translate-x-1/2 whitespace-nowrap cursor-pointer select-none rounded-b-md border bg-white px-4 dark:border-neutral-700 dark:bg-[#111114] flex items-center hover:text-[#846EF7] transition",onClick:U},[c(e(B),{class:"text-base mr-2",icon:"fluent:flash-sparkle-20-regular"}),P(" "+O(e(C))+" ",1),c(e(B),{class:"text-2xl",icon:e($).modelDialog?"ri:arrow-down-s-line":"ri:arrow-right-s-line"},null,8,["icon"])])]))}});const Qo=[{id:1,name:"私人助理",icon:"ri:ai-generate",childList:[{appId:0,prompt:"我希望你能担任英语翻译、拼写校对和修辞改进的角色。我会用任何语言和你交流，你会识别语言，将其翻译并用更为优美和精炼的英语回答我。请将我简单的词汇和句子替换成更为优美和高雅的表达方式，确保意思不变，但使其更具文学性。请仅回答更正和改进的部分，不要写解释。我的第一句话是“how are you ?”，请翻译它。",title:"英语翻译官"},{id:3,appId:0,prompt:"我想让你扮演一个心理学家。我会告诉你我的想法。我希望你能给我科学的建议，让我感觉更好。我的第一个想法，{ 在这里输入你的想法，如果你解释得更详细，我想你会得到更准确的答案。}",title:"心理学家"},{id:4,appId:0,prompt:"请确认我的以下请求。请您作为产品经理回复我。我将会提供一个主题，您将帮助我编写一份包括以下章节标题的PRD文档：主题、简介、问题陈述、目标与目的、用户故事、技术要求、收益、KPI指标、开发风险以及结论。在我要求具体主题、功能或开发的PRD之前，请不要先写任何一份PRD文档。",title:"产品经理"}]},{id:2,name:"轻松娱乐",icon:"ri:lightbulb-flash-line",childList:[{id:5,appId:0,prompt:"我要你做我的私人厨师。我会告诉你我的饮食偏好和过敏，你会建议我尝试的食谱。你应该只回复你推荐的食谱，别无其他。不要写解释。我的第一个请求是“我是一名素食主义者，我正在寻找健康的晚餐点子。”",title:"如何学做菜"},{id:6,appId:0,prompt:"我想让你做一个旅游指南。我会把我的位置写给你，你会推荐一个靠近我的位置的地方。在某些情况下，我还会告诉您我将访问的地方类型。您还会向我推荐靠近我的第一个位置的类似类型的地方。我的第一个建议请求是“我在上海，我只想参观博物馆。",title:"旅游攻略"},{id:7,appId:0,prompt:"如果你能穿越时空，你会去哪个时代？",title:"穿越时空"}]},{id:3,name:"AI百科",icon:"ri:book-mark-line",childList:[{id:8,appId:0,prompt:"解释一下量子力学是什么？",title:"量子力学"},{id:9,appId:0,prompt:"介绍一下人工智能的历史",title:"人工智能"},{id:10,appId:0,prompt:"讲解一下深度学习是如何工作的？",title:"深度学习"}]}],Xo={class:"mb-6 rounded px-4 py-2 text-center text-3xl font-bold text-[#3076fd]",style:{color:"#846EF7"}},en={class:"w-full md:min-w-[450px]"},tn={class:"text-md text-center"},on={class:"line-clamp-1 break-all overflow-hidden"},nn=["onClick"],sn=["src"],ln={class:"line-clamp-1 break-all overflow-hidden"},an={key:0,class:"mt-4 text-center text-sm text-neutral-400"},rn=Q({__name:"index",emits:["prompt"],setup(o,{emit:u}){var w;const i=rt(),d=be(),r=x([]);async function g(){const h=await Zt();h!=null&&h.data&&(h!=null&&h.data.length)?r.value=h==null?void 0:h.data:r.value=Qo}ke(()=>{g()});const v=((w=d.globalConfig)==null?void 0:w.siteRobotName)||"Ai Robot";function k(h){const{appId:$,prompt:I,url:y}=h;if(y){window.open(y);return}$&&$>0?i.push({path:"/chat",query:{appId:$}}):u("prompt",I)}const{isMobile:C}=fe();return(h,$)=>{var I;return a(),p("div",{class:L([[e(C)?"mt-2":"mt-28"],"rounded-md px-4 py-4"])},[t("h1",Xo,O(e(v)),1),t("div",en,[t("div",{class:"grid grid-cols-3 gap-x-2 gap-y-3",style:He({gridTemplateColumns:`repeat(${r.value.length}, minmax(0, 1fr))`})},[(a(!0),p(pe,null,xe(r.value,y=>(a(),p("div",{class:"space-y-4",key:y.id},[t("h2",tn,[c(e(B),{icon:y.icon,class:"mb-2 inline-block text-lg"},null,8,["icon"]),t("p",on,O(y.name),1)]),(a(!0),p(pe,null,xe(y.childList,j=>(a(),p("div",{class:"space-y-e",key:j.id},[t("div",{onClick:N=>k(j),class:L(["py-3 flex justify-center items-center rounded cursor-pointer select-none bg-neutral-100 hover:bg-neutral-200 dark:bg-neutral-900 dark:hover:bg-neutral-800",[e(C)?"px-2":"px-5"]])},[j.coverImg?(a(),p("img",{key:0,class:"w-4 mr-1",src:j.coverImg,alt:""},null,8,sn)):S("",!0),t("div",ln,O(j.title),1)],10,nn)]))),128))]))),128))],4),(I=r.value)!=null&&I.length?(a(),p("div",an," 点击以上话题，快速与我对话 ")):S("",!0)])],2)}}}),cn={key:0,class:"w-full mt-20 px-5"},un={class:"flex"},dn=["src"],pn={class:"flex flex-col"},fn={class:"css-0 mb-2 line-clamp-1 break-all text-lg font-semibold tracking-wide text-[#333] dark:text-[#ffffff]"},hn={class:"flex"},gn={class:"flex flex-col mt-16"},mn=t("span",{class:"font-bold text-[#5a91fc] mb-3"},"示例模板",-1),vn={class:"flex-1 pl-2 pr-5 py-1"},xn=["onClick"],yn=t("span",{class:"circle mr-4"},null,-1),bn={class:"flex-1 select-none text-left"},_n=Q({__name:"index",props:{appInfo:null},emits:["prompt"],setup(o,{emit:u}){function i(d){u("prompt",d)}return(d,r)=>{var g,v;return o.appInfo?(a(),p("div",cn,[t("div",un,[t("img",{class:"w-16 h-16 mr-5",src:o.appInfo.coverImg},null,8,dn),t("div",pn,[t("div",fn,O((g=o.appInfo)==null?void 0:g.name),1),t("div",hn,[t("p",null,O((v=o.appInfo)==null?void 0:v.des),1)])])]),t("div",gn,[mn,t("div",vn,[(a(!0),p(pe,null,xe(o.appInfo.demoData,(k,C)=>(a(),p("div",{key:C,class:"border dark:border-[#ffffff17] px-3 py-1 rounded-md mb-2 flex justify-between items-center cursor-pointer transition hover:border-[#5a91fc] hover:text-[#5a91fc]",onClick:w=>i(k)},[yn,t("div",bn,O(k),1),c(e(B),{class:"w-6 text-xl",icon:"material-symbols:tips-and-updates-outline"})],8,xn))),128))])])])):S("",!0)}}});function kn(){const o=x([]),u=x([]),i=1;function d(v){v.target.nextElementSibling.click()}function r(v){const k=v.target.files;if(k.length>0&&o.value.length<i){const C=k[0],w=3*1024*1024;if(C.size>w){alert("图片大小不能超过3M哦！");return}const h=new FileReader;h.onload=$=>{const I={type:"image_url",image_url:$.target.result};o.value.push(I),u.value.push($.target.result)},h.readAsDataURL(C),v.target.value=""}}function g(v){u.value.splice(v,1),o.value.splice(v,1)}return{imgs:o,imgsys:u,triggerUpload:d,handleImageUpload:r,deleteImage:g}}const wn={class:"h-full flex flex-col bg-white dark:bg-[#111114]"},Cn={class:"flex-1 overflow-hidden"},$n={key:1,class:"flex justify-center items-center"},In={key:2},Tn={class:"sticky bottom-0 left-0 flex justify-center"},Sn={style:{"padding-right":"0.5",height:"auto"},class:"waibk1"},Ln={key:0,style:{display:"block","background-color":"#1fe3e300",height:"30px"}},Bn={key:0,style:{display:"flex","align-items":"center","background-color":"rgba(31, 151, 71, 0)",height:"30px"},class:"imgupload"},Rn={class:"tupiananniu",style:{"margin-left":"0rem"}},An=t("span",{class:"n-button__content"},[t("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",class:"text-lg iconify iconify--line-md",width:"1em",height:"1em",viewBox:"0 0 24 24"},[t("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{"stroke-dasharray":"66","stroke-dashoffset":"66","stroke-width":"2",d:"M3 14V5H21V19H3V14"},[t("animate",{fill:"freeze",attributeName:"stroke-dashoffset",dur:"0.6s",values:"66;0"})]),t("path",{"stroke-dasharray":"26","stroke-dashoffset":"26",d:"M3 16L7 13L10 15L16 10L21 14"},[t("animate",{fill:"freeze",attributeName:"stroke-dashoffset",begin:"0.6s",dur:"0.4s",values:"26;0"})])]),t("circle",{cx:"7.5",cy:"9.5",r:"1.5",fill:"currentColor","fill-opacity":"0"},[t("animate",{fill:"freeze",attributeName:"fill-opacity",begin:"1s",dur:"0.4s",values:"0;1"})])]),P("上传图片")],-1),Dn=t("button",{class:"delete-button",style:{"margin-top":"5px"}},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[t("path",{fill:"currentColor",d:"M7 21q-.825 0-1.412-.587T5 19V6H4V4h5V3h6v1h5v2h-1v13q0 .825-.587 1.413T17 21zM17 6H7v13h10zM9 17h2V8H9zm4 0h2V8h-2zM7 6v13z"})])],-1),Mn=[Dn],jn=["src"],Nn={class:"flex items-center justify-between",style:{}},qn={style:{width:"80px",border:"1px solid rgba(116, 116, 116, 0.268)","border-radius":"5px"}},Un={class:"flex justify-between items-center hover:bg-[#eef0f3] dark:hover:bg-[#33373c]",style:{border:"1px solid rgba(116, 116, 116, 0.268)","padding-top":"5px","padding-bottom":"5px","padding-right":"5px","border-radius":"5px"}},zn={class:"flex items-center text-neutral-400 cursor-pointer hover:text-[#846EF7]"},Gn={class:"flex space-x-2"},On={class:"flex justify-between items-center"},Pn={class:"flex items-center text-neutral-400 cursor-pointer hover:text-[#846EF7] hover:bg-[#eef0f3] dark:hover:bg-[#33373c]",style:{border:"1px solid #6767673d","border-radius":"3px",height:"2rem"}},En=t("div",{class:"mx-4 h-full text-neutral-300 dark:text-neutral-600",style:{"margin-left":"0px"}},null,-1),Vn={class:"w-0 h-0 opacity-0"},Fn={class:"flex items-stretch space-x-2"},Hn={class:"relative flex-1"},Zn={class:"flex w-full flex-col mb-1"},Kn=t("span",{class:"text-neutral-400 mb-1"},"提示词：",-1),Jn={class:"absolute bottom-1 left-2 right-2",style:{width:"50px","margin-left":"auto"}},Wn={class:"flex items-center justify-between",style:{"margin-left":"auto"}},Yn={class:"flex justify-between items-center",style:{"margin-left":"auto"}},Qn={class:"dark:text-black",style:{"font-size":"30px"}},Xn={key:0,class:"w-full flex justify-center items-center py-2 text-xs text-[#aeaeae]"},es={class:"ml-2 transition-all text-[#aeaeae] hover:text-[#60606d]",href:"https://beian.miit.gov.cn",target:"_blank"},ts=Q({__name:"chatBase",setup(o){const{proxy:u,ctx:i}=Ze(),{imgs:d,imgsys:r,triggerUpload:g,handleImageUpload:v,deleteImage:k}=kn(),C=at(),w=be(),h=ct();let $=new AbortController;const I=Kt(),y=_e(),j=Ke(),N=x(),b=se(),E=x(!1),R=x(!0),U=x(null),he=x(""),ge=x(null),z=x(!1),X=f(()=>w.globalConfig),me=f(()=>{var s,l;return((s=X.value)==null?void 0:s.companyName)&&((l=X.value)==null?void 0:l.filingNumber)}),{addGroupChat:Le,updateGroupChat:Je,updateGroupChatSome:Be}=Do(),We=f(()=>h.query.trade_status),Ye=f(()=>h.query.token);Ao();const pt=f(()=>w.isLogin),{isMobile:G}=fe(),{scrollRef:ft,scrollToBottom:we,scrollToBottomIfAtBottom:Re}=Ro(),{usingContext:Ce,toggleUsingContext:Ae}=Mo(),{usingduomo:H,toggleUsingDuomo:De}=No();let ht=ot("imgsqj");const gt=ot("updateimgsqj");ce(H,s=>{u.$usingduomoqj.value=s});const{usingNetwork:le,toggleUsingNetwork:Me}=jo(),A=x(f(()=>b.chatList)),mt=f(()=>A.value.filter(s=>!s.inversion&&!s.error)),Qe=f(()=>{var l;const s=mt.value.filter(D=>{var Z;return(Z=D.conversationOptions)==null?void 0:Z.parentMessageId});return(l=s[s.length-1])==null?void 0:l.conversationOptions}),ee=x(""),V=x(!1),te=x(null),je=x(!0),Ne=x(null),oe=x(""),ae=x(null),qe=f(()=>b.active),J=f(()=>b.groupList.find(s=>s.uuid===b.active)),$e=f(()=>Number(b==null?void 0:b.activeModelKeyType)),Ue=f(()=>J!=null&&J.value?J.value.appId:0),vt=f(()=>C.clipboardText);ce(vt,s=>{var l;ee.value=s,(l=te.value)==null||l.focus(),te.value.scrollTop=te.value.scrollHeight}),ce(Ue,s=>{s?bt(s):U.value=null},{immediate:!0}),ce(qe,s=>{var l;s&&(je.value=!0),te.value&&!G.value&&((l=te.value)==null||l.focus())},{immediate:!0}),ce(A,s=>{s.length!==0&&je.value&&(je.value=!1,we())},{immediate:!0}),ce(H,(s,l)=>{s||(d.value=[],r.value=[])});function xt(){z.value=!0}function yt(s){oe.value=s,ae.value="auto",z.value=!1,ve(()=>et())}async function bt(s){const l=await Jt({id:s});U.value=l.data}function Xe(s){ee.value=s,ye()}function _t(){N.value.scrollIntoView({behavior:"smooth"})}async function ye(s){if(b.groupList.length===0||V.value||!R.value)return;let l="";if(s&&typeof s=="number"){const{requestOptions:D}=A.value[s];l=(D==null?void 0:D.prompt)??""}kt(l)}async function kt(s){let l=s||ee.value;if(oe.value&&!l.includes(oe.value)&&(l=`${oe.value}
${l}`),V.value||!l||l.trim()==="")return;$=new AbortController,Le({dateTime:new Date().toLocaleString(),text:l,inversion:!0,error:!1,conversationOptions:null,requestOptions:{prompt:l,options:null}}),we(),V.value=!0,ee.value="";let D={groupId:+qe.value,usingNetwork:le.value,usingduomo:H.value};Qe.value&&Ce.value&&!le.value&&(D={...Qe.value,...D}),Le({dateTime:new Date().toLocaleString(),text:"AI思考中",loading:!0,inversion:!1,error:!1,conversationOptions:null,requestOptions:{prompt:l,options:{...D}}}),we();const Z=null;let _="",n=null;E.value=!0;let ne={};C.updateIsChatIn(!0);try{await(async()=>{let q=0,W=!0,ie="";async function ze(){var Ie,Te;if(W){_&&_[q]&&(R.value=!1,_.length-q>150?(ie+=_.substring(q,q+10),q+=10):_.length-q>200?(ie+=_.substring(q),q+=_.length-q):(ie+=_[q],q++),Je(A.value.length-1,{dateTime:new Date().toLocaleString(),text:ie,inversion:!1,usage:(Ie=n==null?void 0:n.detail)==null?void 0:Ie.usage,error:!1,loading:!0,conversationOptions:{conversationId:n==null?void 0:n.conversationId,parentMessageId:n==null?void 0:n.id},requestOptions:{prompt:l,options:{...D}}}),Re());const re=ie?ie.length:0,Y=_?_.length:0;if(!E.value&&re===Y){if(R.value=!0,Be(A.value.length-1,{loading:!1,conversationOptions:{conversationId:n==null?void 0:n.conversationId,parentMessageId:n==null?void 0:n.id},requestOptions:{prompt:l,options:{...D}}}),C.updateIsChatIn(!1),Object.keys(ne).length&&w.updateUserBanance(ne),A.value.length===2&&!((Te=J==null?void 0:J.value)!=null&&Te.appId)){const K=A.value[1].text.length>15?A.value[1].text.slice(0,15):A.value[1].text;b.updateGroupInfo({groupId:+qe.value,title:K}).then(()=>{b.queryMyGroup()})}W=!1}_&&_.length&&_.length>ie.length?requestAnimationFrame(ze):setTimeout(()=>{requestAnimationFrame(ze)},1e3)}}requestAnimationFrame(ze),gt(d.value);let jt=JSON.stringify(ht.value);await Yt({imgsup:jt,prompt:l,appId:J.value?J.value.appId:0,options:D,signal:$.signal,onDownloadProgress:({event:Ie})=>{const Te=Ie.target,{responseText:re}=Te;if([1].includes($e.value)){const Y=re.lastIndexOf(`
`,re.length-2);let K=re;Y!==-1&&(K=re.substring(Y));try{n=JSON.parse(K)}catch{console.log("parse data erro from openai: "),K.includes("OpenAI timed out waiting for response")&&y.warning("会话超时了、告知管理员吧~~~")}}if([2,3].includes($e.value)){const Y=re.toString().split(`
`).filter(Ge=>Ge.trim()!=="");let K="",Se={};for(const Ge of Y)try{const Oe=JSON.parse(Ge);K+=Oe.result,Se=Oe}catch{console.log("Json parse 2 3 type error: ")}Se.result=K,n=Se}try{if($e.value===1&&(_=n.text,n!=null&&n.userBanance&&(ne=n==null?void 0:n.userBanance)),[2,3].includes($e.value)){const{result:Y,is_end:K}=n;_=Y,E.value=!K,n!=null&&n.userBanance&&(ne=n==null?void 0:n.userBanance)}}catch{}}})})()}catch(M){C.updateIsChatIn(!1),clearInterval(Z),E.value=!1,(M.code===402||M!=null&&M.message.includes("余额不足")||M!=null&&M.message.includes("免费额度已经使用完毕"))&&(pt.value?C.updateGoodsDialog(!0):w.setLoginDialog(!0));let q=(M==null?void 0:M.message)??T("common.wrong");if(q==="Request failed with status code 401"&&(q="非法操作、请先登录后再进行问答使用！"),M!=null&&M.message.includes("canceled")){Be(A.value.length-1,{loading:!1}),Re(),setTimeout(()=>{w.getUserBalance()},200);return}const W=A.value[A.value.length-1];if(W!=null&&W.text&&W.text!==""){Be(A.value.length-1,{text:`${W.text==="AI思考中"?"":W.text}
[${q}]`,error:!1,loading:!1});return}Je(A.value.length-1,{dateTime:new Date().toLocaleString(),text:q,inversion:!1,error:!0,loading:!1,conversationOptions:null,requestOptions:{prompt:l,options:{...D}}}),Re()}finally{V.value=!1,E.value=!1}await b.queryActiveChatLogList()}async function wt(s){w.setToken(s),st.replace({name:"Chat",query:{}}),y.success("账户登录成功、开始体验吧！"),w.getUserInfo()}function Ct(){We.value.toLowerCase().includes("success")?(y.success("感谢你的购买、祝您使用愉快~",{duration:5e3}),w.getUserInfo(),st.replace({name:"Chat",query:{}})):y.error("您还没有购买成功哦~")}function $t(){if(V.value)return;const s=I.warning({title:T("chat.exportImage"),content:T("chat.exportImageConfirm"),positiveText:T("common.yes"),negativeText:T("common.no"),onPositiveClick:async()=>{try{s.loading=!0;const l=document.getElementById("image-wrapper"),Z=(await Vt(l,{useCORS:!0})).toDataURL("image/png"),_=document.createElement("a");_.style.display="none",_.href=Z,_.setAttribute("download","chat-shot.png"),typeof _.download>"u"&&_.setAttribute("target","_blank"),document.body.appendChild(_),_.click(),document.body.removeChild(_),window.URL.revokeObjectURL(Z),s.loading=!1,y.success(T("chat.exportSuccess")),Promise.resolve()}catch{y.error(T("chat.exportFailed"))}finally{s.loading=!1}}})}function It({chatId:s}){V.value||I.warning({title:T("chat.deleteMessage"),content:T("chat.deleteMessageConfirm"),positiveText:T("common.yes"),negativeText:T("common.no"),onPositiveClick:()=>{b.deleteChatById(s)}})}async function Tt({chatId:s},l){await b.yuyinById(s),u.$loadings.value=!u.$loadings.value}function St(){V.value||I.warning({title:T("chat.clearChat"),content:T("chat.clearChatConfirm"),positiveText:T("common.yes"),negativeText:T("common.no"),onPositiveClick:async()=>{await b.clearChatByGroupId(),y.success("删除当前页面对话完成")}})}function Lt(s){G.value?s.key==="Enter"&&s.ctrlKey&&(s.preventDefault(),ye()):s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),ye())}function Bt(){V.value&&($.abort(),V.value=!1,E.value=!1,R.value=!0)}const Rt=f(()=>G.value?T("chat.placeholderMobile"):T("chat.placeholder")),At=f(()=>V.value||!ee.value||ee.value.trim()===""||!R.value);function et(){var s;Ne.value&&(ae.value=`${(s=Ne.value.getBoundingClientRect())==null?void 0:s.height}px`)}function Dt(){ae.value="auto",oe.value||(ae.value=0),ve(()=>et())}ke(async()=>{b.queryChatPre(),Ye.value&&wt(Ye.value),We.value&&Ct(),ve(async()=>{var s;await b.queryActiveChatLogList(),we(),te.value&&!G.value&&((s=te.value)==null||s.focus())})});const Mt=f(()=>j.theme==="dark");return lt(()=>{V.value&&$.abort()}),(s,l)=>{var D,Z,_;return a(),p("div",wn,[c(Yo,{"using-context":e(Ce),"dark-mode":e(Mt),onExport:$t,onToggleUsingContext:e(Ae),onClear:St,onScrollBtn:_t},null,8,["using-context","dark-mode","onToggleUsingContext"]),t("main",Cn,[t("div",{id:"scrollRef",ref_key:"scrollRef",ref:ft,class:"relative h-full overflow-hidden overflow-y-auto scroll-smooth"},[t("div",{id:"image-wrapper",class:L(["w-full max-w-screen-4xl m-auto dark:bg-[#101014] h-full",[e(G)?"p-2":"p-4"]])},[!A.value.length&&!e(Ue)?(a(),p("div",{key:0,class:L(["flex justify-center items-center text-center",[e(G)?"h-full":"h-4/5 "]])},[c(rn,{onPrompt:Xe})],2)):S("",!0),!A.value.length&&e(Ue)?(a(),p("div",$n,[c(_n,{"app-info":U.value,onPrompt:Xe},null,8,["app-info"])])):S("",!0),A.value.length?(a(),p("div",In,[(a(!0),p(pe,null,xe(A.value,(n,ne)=>(a(),F(e(Lo),{key:n.chatId,"date-time":n.dateTime,text:n.text,inversion:n.inversion,error:n.error,loading:n.loading,loadingbf:n.loadingbf,onRegenerate:M=>ye(ne),onDelete:M=>It(n),onYuyin:M=>Tt(n)},null,8,["date-time","text","inversion","error","loading","loadingbf","onRegenerate","onDelete","onYuyin"]))),128)),t("div",Tn,[V.value?(a(),F(e(de),{key:0,onClick:Bt},{icon:m(()=>[c(e(B),{icon:"ri:stop-circle-line"})]),default:m(()=>[P(" 停止输出 ")]),_:1})):S("",!0)]),t("div",{ref_key:"bottomContainer",ref:N,class:"bottom"},null,512)])):S("",!0)],2)],512)]),t("footer",null,[t("div",Sn,[e(H)?(a(),p("div",Ln,[e(H)?(a(),p("div",Bn,[t("div",Rn,[t("button",{class:"n-button n-button--default-type n-button--medium-type",tabindex:"0",type:"button",onClick:l[1]||(l[1]=(...n)=>e(g)&&e(g)(...n))},[An,t("input",{type:"file",accept:"image/png, image/jpeg",ref:"fileInput",style:{display:"none","background-color":"aqua"},onChange:l[0]||(l[0]=(...n)=>e(v)&&e(v)(...n))},null,544)])]),t("div",{class:"shanchu",style:{"margin-right":"10px","margin-top":"5px","margin-left":"5px"},onClick:l[2]||(l[2]=n=>e(k)(s.index))},Mn),(a(!0),p(pe,null,xe(e(r),(n,ne)=>(a(),p("div",{class:"suolvtu",key:ne},[t("img",{src:n,alt:"缩略图",style:{width:"30px","margin-left":"10px"}},null,8,jn)]))),128))])):S("",!0)])):S("",!0),t("div",Nn,[t("div",qn,[t("div",{class:"flex items-center w-[160px] p-1 mb-1 text-[#846EF7] rounded cursor-pointer transition hover:bg-[#eef0f3] dark:border-neutral-700 dark:hover:bg-[#33373c]",onClick:l[3]||(l[3]=n=>e(C).updateGoodsDialog(!0)),style:{width:"100%","font-size":"0.75rem","margin-bottom":"0rem"}},[c(e(B),{icon:"material-symbols:shopping-bag-outline",class:"mr-1 text-base"}),P(" 订阅会员 ")])]),t("div",Un,[t("div",zn,[t("span",{class:L(["ml-2 mr-2 text-xs",[{"text-[#846EF7]":e(H),"":!e(H)}]]),onClick:l[4]||(l[4]=(...n)=>e(De)&&e(De)(...n)),style:{"margin-bottom":"0rem"}},"4.0多模态",2),c(e(ue),{trigger:"hover",disabled:e(G)},{trigger:m(()=>[c(e(B),{icon:"lets-icons:img-box",class:L(["cursor-pointer mb-0.5",[{"text-[#846EF7]":e(H),"":!e(H)}]]),onClick:e(De)},null,8,["class","onClick"])]),default:m(()=>[P(" "+O(e(H)?"启动多模态":"关闭多模态"),1)]),_:1},8,["disabled"])])]),t("div",Gn,[c(e(ue),{trigger:"hover",placement:"bottom-end",disabled:e(G)},{trigger:m(()=>[t("button",{class:"flex h-8 w-8 items-center justify-center rounded border transition hover:bg-[#eef0f3] dark:border-neutral-700 dark:hover:bg-[#33373c]",onClick:l[5]||(l[5]=(...n)=>e(Ae)&&e(Ae)(...n)),style:{width:"50px",border:"1px #73737326 solid"}},[t("span",{class:L(["",{"text-[#846EF7]":e(Ce),"text-[#9d9c9c]":!e(Ce)}])},[c(e(B),{class:"text-lg",style:{width:"1em",height:"1em"},icon:"ri:chat-history-line"})],2)])]),default:m(()=>[P(" 上下文状态 ")]),_:1},8,["disabled"])]),t("div",On,[t("div",Pn,[t("span",{class:L(["ml-2 mr-2 text-xs",[{"text-[#846EF7]":e(le),"":!e(le)}]]),onClick:l[6]||(l[6]=(...n)=>e(Me)&&e(Me)(...n))},"联网",2),c(e(ue),{trigger:"hover",disabled:e(G)},{trigger:m(()=>[c(e(B),{icon:"zondicons:network",class:L(["cursor-pointer mb-0.5",[{"text-[#846EF7]":e(le),"":!e(le)}]]),onClick:e(Me)},null,8,["class","onClick"])]),default:m(()=>[P(" "+O(e(le)?"关闭联网模式":"开启联网模式"),1)]),_:1},8,["disabled"]),En])])])]),t("div",{class:L([[e(G)?"px-2":"px-4"],"flex space-x-2"])},[(D=e(b).chatPreList)!=null&&D.length?(a(),F(e(it),{key:0,placement:"top-start",style:{width:"200px"},raw:"","show-arrow":!1},{trigger:m(()=>[c(e(ue),{trigger:"hover",placement:"bottom-end",disabled:e(G)},{trigger:m(()=>[t("button",{class:"flex h-8 w-8 items-center justify-center rounded border transition hover:bg-[#eef0f3] dark:border-neutral-700 dark:hover:bg-[#33373c]",onClick:xt},[t("span",null,[c(e(B),{class:"text-lg",style:{width:"1em",height:"1em"},icon:"ic:outline-tips-and-updates"})])])]),default:m(()=>[P(" 学术快问 ")]),_:1},8,["disabled"])]),default:m(()=>[t("div",Vn,[c(e(Wt),{id:"chatPreRef",ref_key:"chatPreRef",ref:ge,modelValue:he.value,"onUpdate:modelValue":l[7]||(l[7]=n=>he.value=n),show:z.value,placement:"top",class:"w-0 h-0 opacity-0 overflow-hidden",placeholder:"请选用当前聊天组所需的模型！","expand-trigger":"click",options:e(b).chatPreList,"check-strategy":"child","on-update:value":yt},null,8,["modelValue","show","options"])])]),_:1})):S("",!0)],2),t("div",{class:L(["m-auto max-w-screen-4xl",[e(G)?"px-2 py-1":"px-4 py-2"]]),style:{"padding-top":"0rem"}},[t("div",Fn,[t("div",Hn,[c(e(nt),{ref_key:"inputRef",ref:te,value:ee.value,"onUpdate:value":l[8]||(l[8]=n=>ee.value=n),type:"textarea",clearable:"",style:He([{paddingTop:ae.value},{"padding-right":"30px"}]),class:"pb-10",autofocus:"",placeholder:e(Rt),autosize:{minRows:e(G)?1:2,maxRows:(e(G),8)},onKeypress:Lt},null,8,["value","style","placeholder","autosize"]),oe.value?(a(),p("div",{key:0,ref_key:"tipsRef",ref:Ne,class:"absolute h-auto top-0 w-full px-3 pt-1 flex justify-between",style:He(ae.value&&{height:ae.value})},[t("div",Zn,[Kn,c(e(nt),{value:oe.value,"onUpdate:value":l[9]||(l[9]=n=>oe.value=n),class:"border-none",type:"textarea",clearable:"",autosize:{minRows:1},"on-input":Dt},null,8,["value"])])],4)):S("",!0),t("div",Jn,[t("div",Wn,[t("div",Yn,[c(e(de),{type:"primary",size:"small",style:{padding:"0px",width:"50px",height:"50px",border:"0px","margin-left":"auto"},disabled:e(At),round:"",onClick:ye},{icon:m(()=>[t("span",Qn,[c(e(B),{icon:"icon-park-outline:send"})])]),_:1},8,["disabled"])])])])])])],2)]),e(me)&&!e(G)?(a(),p("div",Xn,[P(" 版权所有 © "+O((Z=e(X))==null?void 0:Z.companyName)+" ",1),t("a",es,O((_=e(X))==null?void 0:_.filingNumber),1)])):S("",!0)])}}});const os={class:"w-full h-full flex justify-center items-center flex-col"},ns=t("h1",{class:"mb-4 text-2xl font-bold mt-1"},"对话聊天",-1),ss=t("p",{class:"mb-6 text-base text-slate-500"},"点击下方按钮，开始一个新的对话吧",-1),ls=Q({__name:"index",setup(o){const u=se(),i=x(!1);async function d(){i.value=!0;try{await u.addNewChatGroup(),await u.queryMyGroup(),i.value=!1}catch{i.value=!1}}return(r,g)=>(a(),p("div",os,[c(e(B),{icon:"tabler:message",class:"mb-4 inline-block text-6xl text-[#2080f0]"}),ns,ss,c(e(de),{type:"primary",loading:i.value,onClick:d,style:{"--n-color":"#846EF7"}},{default:m(()=>[P("新对话")]),_:1},8,["loading"])]))}}),as={class:"h-full dark:bg-[#24272e] transition-all"},is={class:"w-full flex-1"},ms=Q({__name:"chat",setup(o){const u=ct(),i=rt(),d=Ke(),r=se(),g=be(),{isMobile:v}=fe(),k=f(()=>g.isLogin),C=f(()=>d.siderCollapsed),w=f(()=>r.groupList),h=f(()=>u.query.appId);ce(k,async(j,N)=>{j&&!N&&await r.queryMyGroup()});const $=f(()=>v.value?["rounded-none","shadow-none"]:["rounded-md","shadow-md","dark:border-neutral-800"]),I=f(()=>["h-full",{"pl-[260px]":!v.value&&!C.value}]);async function y(j){const N=+j;i.replace({name:"Chat",query:{}});const b=r.groupList.find(E=>E.appId===N);b?await r.setActiveGroup(b.uuid):(await r.addNewChatGroup(N),await r.queryMyGroup())}return ke(()=>{h.value&&y(h.value)}),(j,N)=>(a(),p("div",as,[t("div",{class:L(["h-full overflow-hidden",e($)])},[c(e(Qt),{class:L(["z-40 transition",e(I)]),"has-sider":""},{default:m(()=>[c(Nt,{class:"h-full"}),t("div",is,[e(w).length?(a(),F(ts,{key:0})):S("",!0),e(w).length?S("",!0):(a(),F(ls,{key:1}))])]),_:1},8,["class"])],2)]))}});export{ms as default};
