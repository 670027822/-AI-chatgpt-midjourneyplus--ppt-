'use strict';const _0x3fa2b9=_0x5116;(function(_0x2b164d,_0x543902){const _0xcb29a7=_0x5116,_0x1e07db=_0x2b164d();while(!![]){try{const _0x398aec=parseInt(_0xcb29a7(0x1c4))/0x1*(-parseInt(_0xcb29a7(0x1c3))/0x2)+parseInt(_0xcb29a7(0x1a2))/0x3*(parseInt(_0xcb29a7(0x1ac))/0x4)+-parseInt(_0xcb29a7(0x1f9))/0x5+-parseInt(_0xcb29a7(0x1cc))/0x6+parseInt(_0xcb29a7(0x203))/0x7+-parseInt(_0xcb29a7(0x1f4))/0x8+parseInt(_0xcb29a7(0x1dc))/0x9;if(_0x398aec===_0x543902)break;else _0x1e07db['push'](_0x1e07db['shift']());}catch(_0x46a370){_0x1e07db['push'](_0x1e07db['shift']());}}}(_0x5ae2,0xb7ea6));var __decorate=this&&this['__decorate']||function(_0x409d1a,_0x223603,_0x2c3289,_0x33b1e2){const _0x4af5ff=_0x5116;var _0x435bc1=arguments[_0x4af5ff(0x1b4)],_0x1bd6a6=_0x435bc1<0x3?_0x223603:_0x33b1e2===null?_0x33b1e2=Object[_0x4af5ff(0x1d8)](_0x223603,_0x2c3289):_0x33b1e2,_0x128b4b;if(typeof Reflect===_0x4af5ff(0x1e1)&&typeof Reflect[_0x4af5ff(0x1f7)]==='function')_0x1bd6a6=Reflect['decorate'](_0x409d1a,_0x223603,_0x2c3289,_0x33b1e2);else{for(var _0x2f58c2=_0x409d1a['length']-0x1;_0x2f58c2>=0x0;_0x2f58c2--)if(_0x128b4b=_0x409d1a[_0x2f58c2])_0x1bd6a6=(_0x435bc1<0x3?_0x128b4b(_0x1bd6a6):_0x435bc1>0x3?_0x128b4b(_0x223603,_0x2c3289,_0x1bd6a6):_0x128b4b(_0x223603,_0x2c3289))||_0x1bd6a6;}return _0x435bc1>0x3&&_0x1bd6a6&&Object[_0x4af5ff(0x1bb)](_0x223603,_0x2c3289,_0x1bd6a6),_0x1bd6a6;},__metadata=this&&this['__metadata']||function(_0x32df1b,_0x2ccc09){const _0x4e3c37=_0x5116;if(typeof Reflect==='object'&&typeof Reflect[_0x4e3c37(0x1ab)]===_0x4e3c37(0x1af))return Reflect[_0x4e3c37(0x1ab)](_0x32df1b,_0x2ccc09);};Object[_0x3fa2b9(0x1bb)](exports,_0x3fa2b9(0x1b8),{'value':!![]}),exports[_0x3fa2b9(0x1ed)]=void 0x0;const common_1=require(_0x3fa2b9(0x1ec)),typeorm_1=require(_0x3fa2b9(0x1bd)),bcrypt=require(_0x3fa2b9(0x1d9));let DatabaseService=class DatabaseService{constructor(_0x25d1cc){const _0x5050b8=_0x3fa2b9;this[_0x5050b8(0x1ee)]=_0x25d1cc;}async[_0x3fa2b9(0x1a5)](){const _0x2ed14a=_0x3fa2b9;await this['checkSuperAdmin'](),await this[_0x2ed14a(0x1c0)]();}async[_0x3fa2b9(0x1b6)](){const _0x53cc0d=_0x3fa2b9,_0x42ec65=await this[_0x53cc0d(0x1ee)]['query'](_0x53cc0d(0x1d0));if(!_0x42ec65||_0x42ec65[_0x53cc0d(0x1b4)]===0x0){const _0xaf25cb=bcrypt[_0x53cc0d(0x1b2)](_0x53cc0d(0x201),0xa),_0x53b3c6=bcrypt[_0x53cc0d(0x1b2)]('123456',0xa),_0x594c9c=_0x53cc0d(0x1c8),_0x5d901e=_0x53cc0d(0x1a1),_0xb635={'username':_0x53cc0d(0x1d5),'password':_0xaf25cb,'status':0x1,'email':_0x594c9c,'sex':0x1,'role':'super'},_0x5501f8={'username':_0x53cc0d(0x1fd),'password':_0x53b3c6,'status':0x1,'email':_0x5d901e,'sex':0x1,'role':'admin'};await this['createDefaultUser'](_0xb635),await this[_0x53cc0d(0x1e9)](_0x5501f8);}}async[_0x3fa2b9(0x1e9)](_0x476b6a){const _0x4ba695=_0x3fa2b9;try{const {username:_0x36e483,password:_0x50f8dc,status:_0x41d525,email:_0x2f0094,role:_0x3229b9}=_0x476b6a,_0x49fa6d=await this[_0x4ba695(0x1ee)][_0x4ba695(0x1b7)](_0x4ba695(0x1c6)+_0x36e483+_0x4ba695(0x1e6)+_0x50f8dc+_0x4ba695(0x1e6)+_0x41d525+_0x4ba695(0x1e6)+_0x2f0094+_0x4ba695(0x1e6)+_0x3229b9+'\x27)'),_0x1c5b32=_0x49fa6d[_0x4ba695(0x1a8)],_0x3e24ff=await this[_0x4ba695(0x1ee)][_0x4ba695(0x1b7)]('INSERT\x20INTO\x20balance\x20(userId,\x20balance,\x20usesLeft,\x20paintCount)\x20VALUES\x20(\x27'+_0x1c5b32+'\x27,\x200,\x201000,\x20100)');common_1['Logger'][_0x4ba695(0x1b1)]('初始化创建'+_0x3229b9+_0x4ba695(0x1c1)+_0x36e483+_0x4ba695(0x1db)+(_0x36e483===_0x4ba695(0x1d5)?'123456':'123456')+_0x4ba695(0x1d2),'DatabaseService');}catch(_0x5dcd28){console['log'](_0x4ba695(0x1a7),_0x5dcd28);throw new common_1['HttpException']('创建默认超级管理员失败！',common_1['HttpStatus'][_0x4ba695(0x1c5)]);}}async[_0x3fa2b9(0x1c0)](){const _0xb10e89=_0x3fa2b9,_0xcfc446=['siteName',_0xb10e89(0x1c2),_0xb10e89(0x202),_0xb10e89(0x1f1),_0xb10e89(0x1bf)],_0x504a67=await this['connection'][_0xb10e89(0x1b7)](_0xb10e89(0x1d1)+_0xcfc446[_0xb10e89(0x1f2)](_0x1595c1=>'\x27'+_0x1595c1+'\x27')[_0xb10e89(0x1fa)](',')+')\x0a'),_0x4417c8=parseInt(_0x504a67[0x0][_0xb10e89(0x1dd)]);_0x4417c8===0x0&&await this[_0xb10e89(0x1ca)]();}async['createBaseSiteConfig'](){const _0x3e0071=_0x3fa2b9;try{const _0x155736=_0x3e0071(0x1ea),_0xf6a882=_0x3e0071(0x1cf),_0x4a3574=[{'configKey':_0x3e0071(0x1a3),'configVal':_0x3e0071(0x1e3),'public':0x1,'encry':0x0},{'configKey':_0x3e0071(0x1c2),'configVal':_0x3e0071(0x1df),'public':0x1,'encry':0x0},{'configKey':_0x3e0071(0x202),'configVal':_0x3e0071(0x1df),'public':0x1,'encry':0x0},{'configKey':'robotAvatar','configVal':'','public':0x1,'encry':0x0},{'configKey':'userDefautlAvatar','configVal':'https://00-1301532507.cos.ap-shanghai.myqcloud.com/ai/1bd2e2f8-5.png','public':0x0,'encry':0x0},{'configKey':_0x3e0071(0x205),'configVal':_0x155736,'public':0x1,'encry':0x0},{'configKey':_0x3e0071(0x1ba),'configVal':'19024441','public':0x0,'encry':0x0},{'configKey':_0x3e0071(0x1e8),'configVal':_0x3e0071(0x1f6),'public':0x0,'encry':0x0},{'configKey':'buyCramiAddress','configVal':'','public':0x1,'encry':0x0},{'configKey':_0x3e0071(0x1e0),'configVal':_0x3e0071(0x207),'public':0x0,'encry':0x0},{'configKey':'noticeInfo','configVal':_0xf6a882,'public':0x1,'encry':0x0},{'configKey':_0x3e0071(0x1b9),'configVal':_0x3e0071(0x206),'public':0x0,'encry':0x0},{'configKey':_0x3e0071(0x1c7),'configVal':'欢迎使用松鼠AI\x20Team团队的产品服务,请在五分钟内完成你的账号激活,点击以下按钮激活您的账号，','public':0x0,'encry':0x0},{'configKey':_0x3e0071(0x1bc),'configVal':'松鼠AI\x20Team团队','public':0x0,'encry':0x0},{'configKey':_0x3e0071(0x1f0),'configVal':'1800','public':0x0,'encry':0x0},{'configKey':_0x3e0071(0x1a9),'configVal':_0x3e0071(0x1cd),'public':0x0,'encry':0x0},{'configKey':_0x3e0071(0x1fb),'configVal':_0x3e0071(0x1e7),'public':0x0,'encry':0x0},{'configKey':_0x3e0071(0x1cb),'configVal':',请妥善保管您的账号，我们将为您赠送50次对话额度和5次绘画额度、祝您使用愉快','public':0x0,'encry':0x0},{'configKey':_0x3e0071(0x1f8),'configVal':_0x3e0071(0x1e4),'public':0x0,'encry':0x0},{'configKey':_0x3e0071(0x1d4),'configVal':_0x3e0071(0x1e7),'public':0x0,'encry':0x0},{'configKey':_0x3e0071(0x209),'configVal':'1','public':0x1,'encry':0x0},{'configKey':_0x3e0071(0x200),'configVal':'30','public':0x1,'encry':0x0},{'configKey':_0x3e0071(0x1ff),'configVal':'3','public':0x1,'encry':0x0},{'configKey':_0x3e0071(0x1d7),'configVal':'3','public':0x1,'encry':0x0},{'configKey':_0x3e0071(0x1ae),'configVal':'1','public':0x1,'encry':0x0},{'configKey':'firstRegisterSendRank','configVal':'500','public':0x1,'encry':0x0},{'configKey':_0x3e0071(0x1e2),'configVal':'20','public':0x1,'encry':0x0},{'configKey':_0x3e0071(0x1d3),'configVal':'2','public':0x1,'encry':0x0},{'configKey':_0x3e0071(0x1de),'configVal':'3','public':0x1,'encry':0x0},{'configKey':_0x3e0071(0x1da),'configVal':'1','public':0x1,'encry':0x0},{'configKey':_0x3e0071(0x1fe),'configVal':'30','public':0x1,'encry':0x0},{'configKey':_0x3e0071(0x1d6),'configVal':'3','public':0x1,'encry':0x0},{'configKey':_0x3e0071(0x1f3),'configVal':'1','public':0x1,'encry':0x0},{'configKey':_0x3e0071(0x1b5),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x3e0071(0x1a4),'configVal':'1','public':0x1,'encry':0x0},{'configKey':'invitedGuestSendDrawMjCount','configVal':'1','public':0x1,'encry':0x0},{'configKey':'isVerifyEmail','configVal':'1','public':0x1,'encry':0x0},{'configKey':'liudonggg','configVal':_0x3e0071(0x1eb),'public':0x1,'encry':0x0},{'configKey':'morenzhuti','configVal':_0x3e0071(0x1be),'public':0x1,'encry':0x0},{'configKey':_0x3e0071(0x1fc),'configVal':'0','public':0x1,'encry':0x0}],_0x8ffd45=await this[_0x3e0071(0x1ee)][_0x3e0071(0x1b7)](_0x3e0071(0x204)+_0x4a3574['map'](_0x5b194e=>'(\x27'+_0x5b194e[_0x3e0071(0x1aa)]+'\x27,\x20\x27'+_0x5b194e[_0x3e0071(0x1e5)][_0x3e0071(0x1ad)](/'/g,'\x5c\x27')+'\x27,\x20\x27'+_0x5b194e[_0x3e0071(0x1f5)]+_0x3e0071(0x1e6)+_0x5b194e['encry']+'\x27)')[_0x3e0071(0x1fa)](',\x20'));common_1['Logger']['log'](_0x3e0071(0x1ef),_0x3e0071(0x1ed));}catch(_0x3b8f50){console[_0x3e0071(0x1b1)](_0x3e0071(0x1a7),_0x3b8f50);throw new common_1[(_0x3e0071(0x208))](_0x3e0071(0x1a6),common_1[_0x3e0071(0x1b3)][_0x3e0071(0x1c5)]);}}};function _0x5116(_0x4b9193,_0x22b6b3){const _0x5ae234=_0x5ae2();return _0x5116=function(_0x51164c,_0x50b0ea){_0x51164c=_0x51164c-0x1a1;let _0x1463b8=_0x5ae234[_0x51164c];return _0x1463b8;},_0x5116(_0x4b9193,_0x22b6b3);}function _0x5ae2(){const _0x20d9dc=['123456','vxNumber','8239126ZVBfvO','INSERT\x20INTO\x20config\x20(configKey,\x20configVal,\x20public,\x20encry)\x20VALUES\x20','baiduCode','松鼠AI\x20Team团队账号验证','https://api.openai.com','HttpException','registerSendStatus','defaultAdmin@cooper.com','4466019MCRzBl','siteName','invitedGuestSendModel4Count','onModuleInit','创建默认网站配置失败！','error:\x20','insertId','registerSuccessEmailTitle','configKey','metadata','4WKTHwm','replace','firstRegisterSendStatus','function','Connection','log','hashSync','HttpStatus','length','invitedGuestSendModel3Count','checkSuperAdmin','query','__esModule','registerVerifyEmailTitle','baiduSiteId','defineProperty','registerVerifyEmailFrom','typeorm','dark','userDefautlAvatar','checkSiteBaseConfig','用户成功、用户名为[','qqNumber','2980244bDzqcv','1VkQCuP','INTERNAL_SERVER_ERROR','INSERT\x20INTO\x20users\x20(username,\x20password,\x20status,\x20email,\x20role)\x20VALUES\x20(\x27','registerVerifyEmailDesc','default@cooper.com','design:paramtypes','createBaseSiteConfig','registerSuccessEmaileAppend','7901064apzhLI','松鼠AI\x20Team团队账号激活成功','Injectable','\x0a####\x20松鼠Ai\x20欢迎您\x0a\x20-\x20松鼠Ai唯一官方网站\x20https://1.mylaws.top\x0a\x20-\x20松鼠Ai\x20作者VX：\x20670027822\x0a\x20-\x20松鼠Ai\x20作者QQ：\x20670027822\x0a\x20-\x20欢迎使用松鼠ai\x0a\x20-\x20初始管理员账号密码\x20\x20super\x20\x20123456\x20【前台后台登录都可以修改】\x0a\x20-\x20初始预览账号密码\x20\x20admin\x20\x20123456\x20【为后台查看账号\x20仅可查看部分非敏感数据】\x0a','SELECT\x20*\x20FROM\x20users\x20WHERE\x20role\x20=\x20\x27super\x27','\x0a\x20\x20SELECT\x20COUNT(*)\x20AS\x20count\x20FROM\x20config\x20WHERE\x20`configKey`\x20IN\x20(',']\x20==============>\x20请注意查阅','firstRregisterSendModel4Count','registerFailEmailTeamName','super','inviteGiveSendModel4Count','registerSendDrawMjCount','getOwnPropertyDescriptor','bcryptjs','inviteSendStatus',']、初始密码为[','31723452YxJJrX','count','firstRregisterSendDrawMjCount','670027822','openaiBaseUrl','object','firstRregisterSendModel3Count','松鼠\x20Ai','松鼠AI\x20Team账号激活失败','configVal','\x27,\x20\x27','松鼠AI\x20Team团队','baiduToken','createDefaultUser','\x0a\x20\x20<script>\x0a\x20\x20var\x20_hmt\x20=\x20_hmt\x20||\x20[];\x0a\x20\x20(function()\x20{\x0a\x20\x20\x20\x20var\x20hm\x20=\x20document.createElement(\x22script\x22);\x0a\x20\x20\x20\x20hm.src\x20=\x20\x22https://hm.baidu.com/hm.js?cb8c9a3bcadbc200e950b05f9c61a385\x22;\x0a\x20\x20\x20\x20var\x20s\x20=\x20document.getElementsByTagName(\x22script\x22)[0];\x0a\x20\x20\x20\x20s.parentNode.insertBefore(hm,\x20s);\x0a\x20\x20})();\x0a\x20\x20</script>\x0a','如遇网站出错，烦请反馈至客服。','@nestjs/common','DatabaseService','connection','初始化网站配置信息成功、如您需要修改网站配置信息，请前往管理系统系统配置设置\x20==============>\x20请注意查阅','registerVerifyExpir','robotAvatar','map','inviteGiveSendDrawMjCount','11280744YEzwfa','public','121.a1600b9b60910feea2ef627ea9776a6f.YGP_CWCOA2lNcIGJ27BwXGxa6nZhBQyLUS4XVaD.TWt9TA','decorate','registerFailEmailTitle','6100710ouoCNq','join','registerSuccessEmailTeamName','huihuaegxs','admin','inviteGiveSendModel3Count','registerSendModel4Count','registerSendModel3Count'];_0x5ae2=function(){return _0x20d9dc;};return _0x5ae2();}DatabaseService=__decorate([(0x0,common_1[_0x3fa2b9(0x1ce)])(),__metadata(_0x3fa2b9(0x1c9),[typeorm_1[_0x3fa2b9(0x1b0)]])],DatabaseService),exports[_0x3fa2b9(0x1ed)]=DatabaseService;