'use strict';const _0x5ae573=_0x226c;function _0x325a(){const _0x1081fb=['9YCnHmQ','/q/55','__metadata','createdAt','ChatLogEntity','@nine.com','24wYZKlC','POST','cos','map','图片成功！','model','function','__decorate','voice','?x-oss-process=image/resize,w_','1456131mwrgfh','../../common/utils','deleteChatLog','username','modelsEntity','546371ZzvTOu','paintCount','length','350pAzXPm','你操作的图片不存在、请检查！','提问时间','chatGroupEntity','save','4381190Anxjjn','exportExcel','findAndCount','recDrawImg','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','3200747zxgMNJ','answer','userId','querAllDrawLog','../chatGroup/chatGroup.entity','columns','forEach','tencent','querAllChatLog','findOne','update','../../common/constants/balance.constant','CHAT_TYPE','ChatLogService','DeductionKey','1371395ETFOVm','ChatGroupEntity','saveChatLog','design:paramtypes','base64','./chatLog.entity','affected','tts-1','当前页面已经没有东西可以删除了！','BAD_REQUEST','defineProperty','extend','取消推荐','group','querAllDrawLog\x20Json\x20parse\x20error','用户名','UserEntity','type','stringify','2063564DwwXeg','DESC','components','tts-1-hd','../user/user.entity','super','metadata','audio/mpeg','45880tnINJB','addRow','?imageView2/1/w/','Like','HttpException','无法加载request模块。错误信息：','key','end','includes','@nestjs/typeorm','用户邮箱','删除对话记录成功！','default','xlsx','assistant','/v1/audio/speech','ali','chatLogEntity','fileInfo','设置\x20forever\x20为\x20true','prompt','HttpStatus','message','request','userEntity','isGroup','PAINT_TYPE','email','parse','toString','Workbook','@nestjs/common','thumbImg','id99999','exceljs','__esModule','你删除的对话记录不存在、请检查！','InjectRepository','querDrawLog','2TQyKpp','chatList','setHeader','exit','getOwnPropertyDescriptor','log','count','object','查询模型','user','moxing','Repository','find','addWorksheet','提问问题','typeorm','Injectable','assign','dall-e-3','回答答案','DALL-E2'];_0x325a=function(){return _0x1081fb;};return _0x325a();}(function(_0x31d63f,_0x5ad7f4){const _0x6cdf0f=_0x226c,_0x55af5b=_0x31d63f();while(!![]){try{const _0x44224c=parseInt(_0x6cdf0f(0x132))/0x1+-parseInt(_0x6cdf0f(0x108))/0x2*(-parseInt(_0x6cdf0f(0x12d))/0x3)+parseInt(_0x6cdf0f(0xd9))/0x4+parseInt(_0x6cdf0f(0xc6))/0x5*(-parseInt(_0x6cdf0f(0x123))/0x6)+parseInt(_0x6cdf0f(0xad))/0x7*(parseInt(_0x6cdf0f(0xe1))/0x8)+-parseInt(_0x6cdf0f(0x11d))/0x9*(parseInt(_0x6cdf0f(0xb2))/0xa)+parseInt(_0x6cdf0f(0xb7))/0xb;if(_0x44224c===_0x5ad7f4)break;else _0x55af5b['push'](_0x55af5b['shift']());}catch(_0x20de2d){_0x55af5b['push'](_0x55af5b['shift']());}}}(_0x325a,0x90133));var __decorate=this&&this[_0x5ae573(0x12a)]||function(_0x50bce7,_0x72e40f,_0x54087c,_0x3994bd){const _0x17c110=_0x5ae573;var _0x3926e2=arguments[_0x17c110(0xac)],_0x165672=_0x3926e2<0x3?_0x72e40f:_0x3994bd===null?_0x3994bd=Object[_0x17c110(0x10c)](_0x72e40f,_0x54087c):_0x3994bd,_0x1c85f4;if(typeof Reflect===_0x17c110(0x10f)&&typeof Reflect['decorate']===_0x17c110(0x129))_0x165672=Reflect['decorate'](_0x50bce7,_0x72e40f,_0x54087c,_0x3994bd);else{for(var _0x139446=_0x50bce7['length']-0x1;_0x139446>=0x0;_0x139446--)if(_0x1c85f4=_0x50bce7[_0x139446])_0x165672=(_0x3926e2<0x3?_0x1c85f4(_0x165672):_0x3926e2>0x3?_0x1c85f4(_0x72e40f,_0x54087c,_0x165672):_0x1c85f4(_0x72e40f,_0x54087c))||_0x165672;}return _0x3926e2>0x3&&_0x165672&&Object[_0x17c110(0xd0)](_0x72e40f,_0x54087c,_0x165672),_0x165672;},__metadata=this&&this[_0x5ae573(0x11f)]||function(_0x2396a3,_0x23fa19){const _0xe0c031=_0x5ae573;if(typeof Reflect===_0xe0c031(0x10f)&&typeof Reflect[_0xe0c031(0xdf)]===_0xe0c031(0x129))return Reflect[_0xe0c031(0xdf)](_0x2396a3,_0x23fa19);},__param=this&&this['__param']||function(_0x3afc0e,_0x5800f6){return function(_0x174ee5,_0x44725e){_0x5800f6(_0x174ee5,_0x44725e,_0x3afc0e);};};Object['defineProperty'](exports,_0x5ae573(0x104),{'value':!![]}),exports['ChatLogService']=void 0x0;const common_1=require(_0x5ae573(0x100)),typeorm_1=require(_0x5ae573(0xea)),chatLog_entity_1=require(_0x5ae573(0xcb)),typeorm_2=require(_0x5ae573(0x117)),balance_constant_1=require(_0x5ae573(0xc2)),user_entity_1=require(_0x5ae573(0xdd)),models_entity_1=require('../models/models.entity'),utils_1=require(_0x5ae573(0x12e)),exceljs_1=require(_0x5ae573(0x103)),chatGroup_entity_1=require(_0x5ae573(0xbb));let ChatLogService=class ChatLogService{constructor(_0x438969,_0x496ba4,_0x255747,_0x504127){const _0x2a1752=_0x5ae573;this[_0x2a1752(0xf2)]=_0x438969,this['userEntity']=_0x496ba4,this[_0x2a1752(0x131)]=_0x255747,this[_0x2a1752(0xb0)]=_0x504127;}async[_0x5ae573(0xc8)](_0xed8551){const _0xd222c9=_0x5ae573;return await this[_0xd222c9(0xf2)][_0xd222c9(0xb1)](_0xed8551);}async[_0x5ae573(0x107)](_0x4cf123,_0x127481){const _0x2ad56=_0x5ae573,{id:_0x17fbcc}=_0x4cf123[_0x2ad56(0x111)],{model:_0xa82eb0}=_0x127481,_0x4abee3={'userId':_0x17fbcc,'type':balance_constant_1['DeductionKey'][_0x2ad56(0xfb)]};_0xa82eb0&&(_0x4abee3[_0x2ad56(0x128)]=_0xa82eb0,_0xa82eb0===_0x2ad56(0x11c)&&(_0x4abee3[_0x2ad56(0x128)]=(0x0,typeorm_2['In'])([_0x2ad56(0x11c),'dall-e-3'])));const _0x9f9cd6=await this[_0x2ad56(0xf2)][_0x2ad56(0x114)]({'where':_0x4abee3,'order':{'id':_0x2ad56(0xda)},'select':['id',_0x2ad56(0xb8),_0x2ad56(0xf5),'message_id',_0x2ad56(0xd3),_0x2ad56(0x128),_0x2ad56(0xd1),_0x2ad56(0xd7),_0x2ad56(0xf3)]});return _0x9f9cd6[_0x2ad56(0xbd)](_0x22728e=>{const _0x79e999=_0x2ad56;if(_0x22728e[_0x79e999(0xd7)]===_0x79e999(0x133)){const _0x25df74=_0x22728e[_0x79e999(0x128)]==='mj'?0x136:0xa0,_0x521705=_0x22728e[_0x79e999(0xb8)][_0x79e999(0xe9)](_0x79e999(0x125))?_0x79e999(0xbe):_0x79e999(0xf1),_0xb497f4=_0x521705===_0x79e999(0xbe)?_0x79e999(0xe3)+_0x25df74+_0x79e999(0x11e):_0x79e999(0x12c)+_0x25df74;_0x22728e[_0x79e999(0x101)]=_0x22728e[_0x79e999(0xb8)]+_0xb497f4;try{_0x22728e[_0x79e999(0xf3)]=_0x22728e[_0x79e999(0xf3)]?JSON[_0x79e999(0xfd)](_0x22728e[_0x79e999(0xf3)]):null;}catch(_0x19a313){_0x22728e[_0x79e999(0xf3)]={};}}}),_0x9f9cd6;}async[_0x5ae573(0xba)](_0xc2e0ae){const _0x43e6b8=_0x5ae573,{page:page=0x1,size:size=0x14,rec:_0x57048b,userId:_0x4a0147,model:_0x300c95}=_0xc2e0ae,_0x1b7897={'type':balance_constant_1['DeductionKey'][_0x43e6b8(0xfb)],'prompt':(0x0,typeorm_2['Not'])(''),'answer':(0x0,typeorm_2['Not'])('')};_0x57048b&&Object[_0x43e6b8(0x119)](_0x1b7897,{'rec':_0x57048b}),_0x4a0147&&Object[_0x43e6b8(0x119)](_0x1b7897,{'userId':_0x4a0147});_0x300c95&&(_0x1b7897[_0x43e6b8(0x128)]=_0x300c95,_0x300c95==='DALL-E2'&&(_0x1b7897[_0x43e6b8(0x128)]=(0x0,typeorm_2['In'])([_0x43e6b8(0x11c),_0x43e6b8(0x11a)])));const [_0x37589e,_0x352e73]=await this[_0x43e6b8(0xf2)][_0x43e6b8(0xb4)]({'order':{'id':_0x43e6b8(0xda)},'skip':(page-0x1)*size,'take':size,'where':_0x1b7897});return _0x37589e[_0x43e6b8(0xbd)](_0x1919a1=>{const _0x4d0a8a=_0x43e6b8;var _0x42bdd3;if(_0x1919a1[_0x4d0a8a(0xd7)]===_0x4d0a8a(0x133)){const _0x310a48=_0x1919a1[_0x4d0a8a(0x128)]==='mj'?0x136:0xa0,_0x4e8684=_0x1919a1[_0x4d0a8a(0xb8)][_0x4d0a8a(0xe9)](_0x4d0a8a(0x125))?_0x4d0a8a(0xbe):_0x4d0a8a(0xf1),_0x53faa3=_0x4e8684===_0x4d0a8a(0xbe)?_0x4d0a8a(0xe3)+_0x310a48+_0x4d0a8a(0x11e):'?x-oss-process=image/resize,w_'+_0x310a48;_0x1919a1[_0x4d0a8a(0x101)]=_0x1919a1[_0x4d0a8a(0xb8)]+_0x53faa3;try{const _0x1cbf31=_0x1919a1[_0x4d0a8a(0xd1)]?JSON[_0x4d0a8a(0xfd)](_0x1919a1[_0x4d0a8a(0xd1)]):null;_0x1cbf31&&(_0x1cbf31?_0x1919a1[_0x4d0a8a(0xfa)]=((_0x42bdd3=_0x1cbf31===null||_0x1cbf31===void 0x0?void 0x0:_0x1cbf31['components'][0x0])===null||_0x42bdd3===void 0x0?void 0x0:_0x42bdd3[_0x4d0a8a(0xdb)][_0x4d0a8a(0xac)])===0x5:_0x1919a1[_0x4d0a8a(0xfa)]=![]);}catch(_0x53f572){console[_0x4d0a8a(0x10d)](_0x4d0a8a(0xd4),_0x53f572);}}}),{'rows':_0x37589e,'count':_0x352e73};}async[_0x5ae573(0xb5)](_0x2d1ccc){const _0x34f51d=_0x5ae573,{id:_0x509b9b}=_0x2d1ccc,_0x243a4e=await this[_0x34f51d(0xf2)][_0x34f51d(0xc0)]({'where':{'id':_0x509b9b,'type':balance_constant_1[_0x34f51d(0xc5)][_0x34f51d(0xfb)]}});if(!_0x243a4e)throw new common_1[(_0x34f51d(0xe5))]('你推荐的图片不存在、请检查！',common_1['HttpStatus']['BAD_REQUEST']);const _0x5d1a4c=_0x243a4e['rec']===0x1?0x0:0x1,_0x1cc3ca=await this[_0x34f51d(0xf2)][_0x34f51d(0xc1)]({'id':_0x509b9b},{'rec':_0x5d1a4c});if(_0x1cc3ca[_0x34f51d(0xcc)]>0x0)return(_0x5d1a4c?'推荐':_0x34f51d(0xd2))+_0x34f51d(0x127);throw new common_1[(_0x34f51d(0xe5))](_0x34f51d(0xae),common_1[_0x34f51d(0xf6)][_0x34f51d(0xcf)]);}async[_0x5ae573(0xb3)](_0x41f5a2,_0x2b7db4){const _0x47a6f8=_0x5ae573,_0x5dd61e={'type':balance_constant_1[_0x47a6f8(0xc5)][_0x47a6f8(0xc3)]},{page:page=0x1,size:size=0x1e,prompt:_0x4dca5a,email:_0x18e185}=_0x41f5a2;_0x4dca5a&&Object[_0x47a6f8(0x119)](_0x5dd61e,{'prompt':(0x0,typeorm_2[_0x47a6f8(0xe4)])('%'+_0x4dca5a+'%')});if(_0x18e185){const _0x4c4d4d=await this[_0x47a6f8(0xf9)][_0x47a6f8(0xc0)]({'where':{'email':_0x18e185}});(_0x4c4d4d===null||_0x4c4d4d===void 0x0?void 0x0:_0x4c4d4d['id'])&&Object['assign'](_0x5dd61e,{'userId':_0x4c4d4d['id']});}const [_0x49b64c,_0x197274]=await this['chatLogEntity']['findAndCount']({'order':{'id':'DESC'},'skip':(page-0x1)*size,'take':size,'where':_0x5dd61e}),_0x17d486=_0x49b64c[_0x47a6f8(0x126)](_0x48c599=>_0x48c599[_0x47a6f8(0xb9)]),_0x5c1aa3=await this[_0x47a6f8(0xf9)][_0x47a6f8(0x114)]({'where':{'id':(0x0,typeorm_2['In'])(_0x17d486)}}),_0xc898ff=_0x49b64c[_0x47a6f8(0x126)](_0x2c3867=>{const _0x585af7=_0x47a6f8,_0x2016c2=_0x5c1aa3['find'](_0x4049e4=>_0x4049e4['id']===_0x2c3867[_0x585af7(0xb9)]);return{'username':_0x2016c2?_0x2016c2[_0x585af7(0x130)]:'','email':_0x2016c2?_0x2016c2['email']:'','prompt':_0x2c3867[_0x585af7(0xf5)],'answer':_0x2c3867[_0x585af7(0xb8)],'createdAt':(0x0,utils_1['formatDate'])(_0x2c3867[_0x585af7(0x120)])};}),_0x357f9c=new exceljs_1[(_0x47a6f8(0xed))][(_0x47a6f8(0xff))](),_0x388dd9=_0x357f9c[_0x47a6f8(0x115)]('chatlog');_0x388dd9[_0x47a6f8(0xbc)]=[{'header':_0x47a6f8(0xd5),'key':_0x47a6f8(0x130),'width':0x14},{'header':_0x47a6f8(0xeb),'key':'email','width':0x14},{'header':_0x47a6f8(0xaf),'key':_0x47a6f8(0x120),'width':0x14},{'header':_0x47a6f8(0x116),'key':'prompt','width':0x50},{'header':_0x47a6f8(0x11b),'key':'answer','width':0x96}],_0xc898ff[_0x47a6f8(0xbd)](_0x4f9a56=>_0x388dd9[_0x47a6f8(0xe2)](_0x4f9a56)),_0x2b7db4[_0x47a6f8(0x10a)]('Content-Type',_0x47a6f8(0xb6)),_0x2b7db4[_0x47a6f8(0x10a)]('Content-Disposition','attachment;\x20filename='+'chat.xlsx'),await _0x357f9c[_0x47a6f8(0xee)]['write'](_0x2b7db4),_0x2b7db4[_0x47a6f8(0xe8)]();}async[_0x5ae573(0xbf)](_0x3a78d3,_0xf0d38f){const _0x3420d0=_0x5ae573,{page:page=0x1,size:size=0x14,userId:_0x4518a8,prompt:_0x3363a4}=_0x3a78d3,_0x34502c={'type':balance_constant_1[_0x3420d0(0xc5)]['CHAT_TYPE'],'prompt':(0x0,typeorm_2['Not'])('')};_0x4518a8&&Object[_0x3420d0(0x119)](_0x34502c,{'userId':_0x4518a8}),_0x3363a4&&Object['assign'](_0x34502c,{'prompt':(0x0,typeorm_2[_0x3420d0(0xe4)])('%'+_0x3363a4+'%')});const [_0x190915,_0x582255]=await this['chatLogEntity'][_0x3420d0(0xb4)]({'order':{'id':_0x3420d0(0xda)},'skip':(page-0x1)*size,'take':size,'where':_0x34502c}),_0xc8267e=_0x190915['map'](_0x336c36=>_0x336c36['userId']),_0x260b82=await this[_0x3420d0(0xf9)][_0x3420d0(0x114)]({'where':{'id':(0x0,typeorm_2['In'])(_0xc8267e)},'select':['id',_0x3420d0(0x130),_0x3420d0(0xfc)]});return _0x190915[_0x3420d0(0xbd)](_0x23b887=>{const _0x12511e=_0x3420d0,{username:_0x571b2e,email:_0x27776b}=_0x260b82['find'](_0x4abaa5=>_0x4abaa5['id']===_0x23b887[_0x12511e(0xb9)])||{};_0x23b887[_0x12511e(0x130)]=_0x571b2e,_0x23b887[_0x12511e(0xfc)]=_0x27776b;}),_0xf0d38f[_0x3420d0(0x111)]['role']!==_0x3420d0(0xde)&&_0x190915[_0x3420d0(0xbd)](_0x4b07ec=>_0x4b07ec['email']=(0x0,utils_1['maskEmail'])(_0x4b07ec[_0x3420d0(0xfc)])),_0x190915[_0x3420d0(0xbd)](_0x235661=>{const _0x27d761=_0x3420d0;!_0x235661['email']&&(_0x235661[_0x27d761(0xfc)]=(_0x235661===null||_0x235661===void 0x0?void 0x0:_0x235661[_0x27d761(0xb9)])+_0x27d761(0x122)),!_0x235661[_0x27d761(0x130)]&&(_0x235661['username']='游客'+(_0x235661===null||_0x235661===void 0x0?void 0x0:_0x235661['userId']));}),{'rows':_0x190915,'count':_0x582255};}async[_0x5ae573(0x109)](_0xaae9f4,_0x4233a3){const _0x1100bd=_0x5ae573,{id:_0x1f72d2}=_0xaae9f4[_0x1100bd(0x111)],{groupId:_0x355a38}=_0x4233a3,_0x1e40f2={'userId':_0x1f72d2,'isDelete':![]};_0x355a38&&Object[_0x1100bd(0x119)](_0x1e40f2,{'groupId':_0x355a38});if(_0x355a38){const _0x531c0b=await this['chatGroupEntity'][_0x1100bd(0x10e)]({'where':{'isDelete':![]}});if(_0x531c0b===0x0)return[];}const _0x30f2e3=await this[_0x1100bd(0xf2)][_0x1100bd(0x114)]({'where':_0x1e40f2});return _0x30f2e3[_0x1100bd(0x126)](_0x4e9d3d=>{const _0x4ecbe2=_0x1100bd,{prompt:_0xdcb3b2,role:_0x322914,answer:_0x6f31bb,createdAt:_0x8e56be,model:_0x274fab,conversationOptions:_0x4d3aae,requestOptions:_0x40a2c0,id:_0x1f1f1b}=_0x4e9d3d;let _0x498982=null,_0x1ecfee=null;try{_0x498982=JSON['parse'](_0x4d3aae),_0x1ecfee=JSON[_0x4ecbe2(0xfd)](_0x40a2c0);}catch(_0x5c5dea){}return{'chatId':_0x1f1f1b,'dateTime':(0x0,utils_1['formatDate'])(_0x8e56be),'text':_0x322914===_0x4ecbe2(0x111)?_0xdcb3b2:_0x6f31bb,'inversion':_0x322914==='user','error':![],'conversationOptions':_0x498982,'requestOptions':_0x1ecfee,'loadingbf':![]};});}async[_0x5ae573(0x12f)](_0x10bee0,_0x51f5f1){const _0x48cb38=_0x5ae573,{id:_0x4548c0}=_0x10bee0['user'],{id:_0x16df4b}=_0x51f5f1,_0x2099a7=await this[_0x48cb38(0xf2)][_0x48cb38(0xc0)]({'where':{'id':_0x16df4b,'userId':_0x4548c0}});if(!_0x2099a7)throw new common_1[(_0x48cb38(0xe5))](_0x48cb38(0x105),common_1[_0x48cb38(0xf6)][_0x48cb38(0xcf)]);const _0x6b3597=await this[_0x48cb38(0xf2)]['update']({'id':_0x16df4b},{'isDelete':!![]});if(_0x6b3597[_0x48cb38(0xcc)]>0x0)return _0x48cb38(0xec);else throw new common_1[(_0x48cb38(0xe5))](_0x48cb38(0x105),common_1[_0x48cb38(0xf6)]['BAD_REQUEST']);}async['yuyinChatLog'](_0x3208db,_0x2170a8){const _0x1941ee=_0x5ae573;console[_0x1941ee(0x10d)]('id',_0x2170a8),console[_0x1941ee(0x10d)](_0x1941ee(0x102));const {id:_0x1fb32d}=_0x3208db[_0x1941ee(0x111)];console[_0x1941ee(0x10d)]('查询对话');const _0x16a06f=await this['chatLogEntity'][_0x1941ee(0xc0)]({'where':{'id':_0x2170a8,'userId':_0x1fb32d}});let _0x543a24=_0x16a06f[_0x1941ee(0xb8)];console[_0x1941ee(0x10d)](_0x1941ee(0xf4));let _0x242db4;try{_0x242db4=require(_0x1941ee(0xf8));}catch(_0x2d3d85){console['error'](_0x1941ee(0xe6),_0x2d3d85[_0x1941ee(0xf7)]),process[_0x1941ee(0x10b)](0x1);}console[_0x1941ee(0x10d)](_0x1941ee(0x110));const _0x2b77d9=await this[_0x1941ee(0x131)][_0x1941ee(0xc0)]({'where':[{'model':_0x1941ee(0xdc)},{'model':_0x1941ee(0xcd)}]});console[_0x1941ee(0x10d)](_0x1941ee(0x112),_0x2b77d9);const _0x1330ec=_0x2b77d9[_0x1941ee(0xe7)],_0x5ae8d2=_0x2b77d9['proxyUrl']||'https://api.openai.com',_0x3d1094=_0x2b77d9[_0x1941ee(0x12b)],_0x3d8280=_0x2b77d9[_0x1941ee(0x128)],_0x49f5d7=_0x5ae8d2+_0x1941ee(0xf0);var _0x5d0d06={'Authorization':'Bearer\x20'+_0x1330ec,'Content-Type':'application/json','Accept':_0x1941ee(0xe0)},_0x347c8d=JSON[_0x1941ee(0xd8)]({'model':_0x3d8280,'input':_0x543a24,'voice':_0x3d1094}),_0x50ecc0={'url':_0x49f5d7,'method':_0x1941ee(0x124),'headers':_0x5d0d06,'body':_0x347c8d,'encoding':null};const _0x1d4f62=await new Promise((_0x1cf3dd,_0x3a8360)=>{function _0x48eb2c(_0x1eea6f,_0x15f091,_0x597945){const _0x20f3d3=_0x226c;if(!_0x1eea6f&&_0x15f091['statusCode']==0xc8){const _0x4b8d68=_0x597945[_0x20f3d3(0xfe)](_0x20f3d3(0xca));_0x1cf3dd(_0x4b8d68);}else _0x3a8360(_0x1eea6f);}_0x242db4(_0x50ecc0,_0x48eb2c);});return _0x1d4f62;}async['delByGroupId'](_0xade796,_0xd67ac2){const _0x67780e=_0x5ae573,{groupId:_0x31a65e}=_0xd67ac2,{id:_0x3952e4}=_0xade796[_0x67780e(0x111)],_0x3360e3=await this[_0x67780e(0xb0)][_0x67780e(0xc0)]({'where':{'id':_0x31a65e,'userId':_0x3952e4}});if(!_0x3360e3)throw new common_1[(_0x67780e(0xe5))]('你删除的对话记录不存在、请检查！',common_1[_0x67780e(0xf6)][_0x67780e(0xcf)]);const _0x272517=await this[_0x67780e(0xf2)][_0x67780e(0xc1)]({'groupId':_0x31a65e},{'isDelete':!![]});if(_0x272517['affected']>0x0)return _0x67780e(0xec);if(_0x272517[_0x67780e(0xcc)]===0x0)throw new common_1[(_0x67780e(0xe5))](_0x67780e(0xce),common_1[_0x67780e(0xf6)][_0x67780e(0xcf)]);}async['byAppId'](_0x25867e,_0x21d6cb){const _0x164b10=_0x5ae573,{id:_0x4b209b}=_0x25867e[_0x164b10(0x111)],{appId:_0x101c57,page:page=0x1,size:size=0xa}=_0x21d6cb,[_0x3dcade,_0x42f768]=await this[_0x164b10(0xf2)][_0x164b10(0xb4)]({'where':{'userId':_0x4b209b,'appId':_0x101c57,'role':_0x164b10(0xef)},'order':{'id':_0x164b10(0xda)},'take':size,'skip':(page-0x1)*size});return{'rows':_0x3dcade,'count':_0x42f768};}};function _0x226c(_0x37d05b,_0x192068){const _0x325a53=_0x325a();return _0x226c=function(_0x226cbe,_0x14f603){_0x226cbe=_0x226cbe-0xac;let _0x18f0e8=_0x325a53[_0x226cbe];return _0x18f0e8;},_0x226c(_0x37d05b,_0x192068);}ChatLogService=__decorate([(0x0,common_1[_0x5ae573(0x118)])(),__param(0x0,(0x0,typeorm_1[_0x5ae573(0x106)])(chatLog_entity_1[_0x5ae573(0x121)])),__param(0x1,(0x0,typeorm_1[_0x5ae573(0x106)])(user_entity_1[_0x5ae573(0xd6)])),__param(0x2,(0x0,typeorm_1['InjectRepository'])(models_entity_1['ModelsEntity'])),__param(0x3,(0x0,typeorm_1['InjectRepository'])(chatGroup_entity_1[_0x5ae573(0xc7)])),__metadata(_0x5ae573(0xc9),[typeorm_2[_0x5ae573(0x113)],typeorm_2['Repository'],typeorm_2['Repository'],typeorm_2[_0x5ae573(0x113)]])],ChatLogService),exports[_0x5ae573(0xc4)]=ChatLogService;