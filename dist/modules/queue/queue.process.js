'use strict';function _0x85d4(_0x1c806d,_0x44c42f){var _0xc6a5ff=_0xc6a5();return _0x85d4=function(_0x85d471,_0x386615){_0x85d471=_0x85d471-0x85;var _0x58ea68=_0xc6a5ff[_0x85d471];return _0x58ea68;},_0x85d4(_0x1c806d,_0x44c42f);}var _0x1ca6aa=_0x85d4;function _0xc6a5(){var _0xf366c4=['draw','onQueueActive','队列暂停的时候调用','2939208eTABgG','OnQueueFailed','OnQueueCompleted','onQueueCompleted','handleJob','onQueueFailed','QueueProcessor','design:type','getOwnPropertyDescriptor','1103004YFVTeQ','onQueuePaused','12GLaZjD','OnQueueProgress','313688IHUjHa','167620JnIXpy','metadata','Queue\x20cleaned:\x20','../midjourney/midjourney.service','name','Processor','OnQueueActive','1143240yjverH','8188DsgOyL','design:paramtypes','Logger','OnQueuePaused','OnQueueDrained','defineProperty','onQueueError','CONCURRENCY','__esModule','data','\x20were\x20cleaned.','队列任务的一个回调用于通知当前进度','log','111916ksEJfE','队列恢复的时候调用','prototype','队列发生错误','Queue\x20failed:\x20','MJDRAW','OnQueueError','function','object','env','onQueueResumed',':\x20绘画失败\x20','drawFailed','length','midjourneyService','decorate','Process','onQueueDrained','@nestjs/bull','design:returntype','onQueueProgress','logger'];_0xc6a5=function(){return _0xf366c4;};return _0xc6a5();}(function(_0x6e3abb,_0x10c095){var _0xe0578d=_0x85d4,_0x54634f=_0x6e3abb();while(!![]){try{var _0x342f75=parseInt(_0xe0578d(0x8d))/0x1+-parseInt(_0xe0578d(0xc0))/0x2+-parseInt(_0xe0578d(0xbe))/0x3*(parseInt(_0xe0578d(0x9a))/0x4)+parseInt(_0xe0578d(0x85))/0x5+-parseInt(_0xe0578d(0x8c))/0x6+parseInt(_0xe0578d(0xbc))/0x7+parseInt(_0xe0578d(0xb3))/0x8;if(_0x342f75===_0x10c095)break;else _0x54634f['push'](_0x54634f['shift']());}catch(_0x4b399d){_0x54634f['push'](_0x54634f['shift']());}}}(_0xc6a5,0x1a379));var __decorate=this&&this['__decorate']||function(_0x19c269,_0x5b0fd0,_0x48bffd,_0x39c4ad){var _0x7c5377=_0x85d4,_0x173462=arguments[_0x7c5377(0xa7)],_0x384cb3=_0x173462<0x3?_0x5b0fd0:_0x39c4ad===null?_0x39c4ad=Object[_0x7c5377(0xbb)](_0x5b0fd0,_0x48bffd):_0x39c4ad,_0x1a74da;if(typeof Reflect===_0x7c5377(0xa2)&&typeof Reflect[_0x7c5377(0xa9)]==='function')_0x384cb3=Reflect[_0x7c5377(0xa9)](_0x19c269,_0x5b0fd0,_0x48bffd,_0x39c4ad);else{for(var _0x258336=_0x19c269['length']-0x1;_0x258336>=0x0;_0x258336--)if(_0x1a74da=_0x19c269[_0x258336])_0x384cb3=(_0x173462<0x3?_0x1a74da(_0x384cb3):_0x173462>0x3?_0x1a74da(_0x5b0fd0,_0x48bffd,_0x384cb3):_0x1a74da(_0x5b0fd0,_0x48bffd))||_0x384cb3;}return _0x173462>0x3&&_0x384cb3&&Object['defineProperty'](_0x5b0fd0,_0x48bffd,_0x384cb3),_0x384cb3;},__metadata=this&&this['__metadata']||function(_0x47d7ea,_0x2d640a){var _0x5488f4=_0x85d4;if(typeof Reflect===_0x5488f4(0xa2)&&typeof Reflect[_0x5488f4(0x86)]===_0x5488f4(0xa1))return Reflect[_0x5488f4(0x86)](_0x47d7ea,_0x2d640a);},QueueProcessor_1;Object[_0x1ca6aa(0x92)](exports,_0x1ca6aa(0x95),{'value':!![]}),exports[_0x1ca6aa(0xb9)]=void 0x0;const bull_1=require(_0x1ca6aa(0xac)),common_1=require('@nestjs/common'),midjourney_service_1=require(_0x1ca6aa(0x88));let QueueProcessor=QueueProcessor_1=class QueueProcessor{constructor(_0x1906e3){var _0x35d7bf=_0x1ca6aa;this['midjourneyService']=_0x1906e3,this[_0x35d7bf(0xaf)]=new common_1[(_0x35d7bf(0x8f))](QueueProcessor_1[_0x35d7bf(0x89)]);}async[_0x1ca6aa(0xb7)](_0x58f035){var _0xdb95b7=_0x1ca6aa;const _0x365d29=await this[_0xdb95b7(0xa8)][_0xdb95b7(0xb0)](_0x58f035[_0xdb95b7(0x96)],_0x58f035['id']);return _0x365d29;}['onQueueActive'](_0x3b3c4f){}['onQueueError'](_0x4ae833){var _0x1f9f80=_0x1ca6aa;console[_0x1f9f80(0x99)](_0x1f9f80(0x9d),_0x4ae833);}[_0x1ca6aa(0xae)](_0x37d6c6,_0x56b389){var _0x718854=_0x1ca6aa;console[_0x718854(0x99)](_0x718854(0x98),_0x37d6c6['id'],_0x56b389);}[_0x1ca6aa(0xb6)](_0x59d554,_0x53a42f){}[_0x1ca6aa(0xb8)](_0x1c0086,_0x28326c){var _0x1f2dc2=_0x1ca6aa;common_1[_0x1f2dc2(0x8f)]['error'](_0x1f2dc2(0x9e)+_0x28326c['message']+_0x1f2dc2(0xa5)+_0x1c0086['id'],_0x1f2dc2(0xb9)),this[_0x1f2dc2(0xa8)][_0x1f2dc2(0xa6)](_0x1c0086['data']);}[_0x1ca6aa(0xbd)](){var _0x30bb69=_0x1ca6aa;console[_0x30bb69(0x99)](_0x30bb69(0xb2));}[_0x1ca6aa(0xa4)](){var _0xcd8ee=_0x1ca6aa;console[_0xcd8ee(0x99)](_0xcd8ee(0x9b));}['onQueueCleaned'](_0x321ac5,_0x30120d){var _0x11b223=_0x1ca6aa;common_1['Logger'][_0x11b223(0x99)](_0x11b223(0x87)+_0x321ac5[_0x11b223(0xa7)]+'\x20jobs\x20of\x20type\x20'+_0x30120d+_0x11b223(0x97),'QueueProcessor');}[_0x1ca6aa(0xab)](){}};__decorate([(0x0,bull_1[_0x1ca6aa(0xaa)])({'name':'mjDraw','concurrency':process[_0x1ca6aa(0xa3)]['CONCURRENCY']?+process['env'][_0x1ca6aa(0x94)]:0x3}),__metadata(_0x1ca6aa(0xba),Function),__metadata('design:paramtypes',[Object]),__metadata('design:returntype',Promise)],QueueProcessor[_0x1ca6aa(0x9c)],'handleJob',null),__decorate([(0x0,bull_1[_0x1ca6aa(0x8b)])(),__metadata(_0x1ca6aa(0xba),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x1ca6aa(0xad),void 0x0)],QueueProcessor['prototype'],_0x1ca6aa(0xb1),null),__decorate([(0x0,bull_1[_0x1ca6aa(0xa0)])(),__metadata(_0x1ca6aa(0xba),Function),__metadata(_0x1ca6aa(0x8e),[Error]),__metadata(_0x1ca6aa(0xad),void 0x0)],QueueProcessor[_0x1ca6aa(0x9c)],_0x1ca6aa(0x93),null),__decorate([(0x0,bull_1[_0x1ca6aa(0xbf)])(),__metadata(_0x1ca6aa(0xba),Function),__metadata(_0x1ca6aa(0x8e),[Object,Number]),__metadata(_0x1ca6aa(0xad),void 0x0)],QueueProcessor[_0x1ca6aa(0x9c)],_0x1ca6aa(0xae),null),__decorate([(0x0,bull_1[_0x1ca6aa(0xb5)])(),__metadata(_0x1ca6aa(0xba),Function),__metadata(_0x1ca6aa(0x8e),[Object,Object]),__metadata('design:returntype',void 0x0)],QueueProcessor['prototype'],_0x1ca6aa(0xb6),null),__decorate([(0x0,bull_1[_0x1ca6aa(0xb4)])(),__metadata(_0x1ca6aa(0xba),Function),__metadata(_0x1ca6aa(0x8e),[Object,Error]),__metadata(_0x1ca6aa(0xad),void 0x0)],QueueProcessor[_0x1ca6aa(0x9c)],_0x1ca6aa(0xb8),null),__decorate([(0x0,bull_1[_0x1ca6aa(0x90)])(),__metadata(_0x1ca6aa(0xba),Function),__metadata(_0x1ca6aa(0x8e),[]),__metadata(_0x1ca6aa(0xad),void 0x0)],QueueProcessor[_0x1ca6aa(0x9c)],'onQueuePaused',null),__decorate([(0x0,bull_1['OnQueueResumed'])(),__metadata('design:type',Function),__metadata(_0x1ca6aa(0x8e),[]),__metadata(_0x1ca6aa(0xad),void 0x0)],QueueProcessor[_0x1ca6aa(0x9c)],'onQueueResumed',null),__decorate([(0x0,bull_1['OnQueueCleaned'])(),__metadata(_0x1ca6aa(0xba),Function),__metadata(_0x1ca6aa(0x8e),[Array,String]),__metadata('design:returntype',void 0x0)],QueueProcessor['prototype'],'onQueueCleaned',null),__decorate([(0x0,bull_1[_0x1ca6aa(0x91)])(),__metadata('design:type',Function),__metadata(_0x1ca6aa(0x8e),[]),__metadata(_0x1ca6aa(0xad),void 0x0)],QueueProcessor[_0x1ca6aa(0x9c)],_0x1ca6aa(0xab),null),QueueProcessor=QueueProcessor_1=__decorate([(0x0,bull_1[_0x1ca6aa(0x8a)])(_0x1ca6aa(0x9f)),__metadata('design:paramtypes',[midjourney_service_1['MidjourneyService']])],QueueProcessor),exports[_0x1ca6aa(0xb9)]=QueueProcessor;